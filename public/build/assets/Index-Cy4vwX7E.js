import{K as z,r as a,j as e,L as K,$ as H,S as d}from"./app-CDPwVV6Y.js";import{S as V,H as G,F as Q}from"./AdminLayout-BW3ywimG.js";import{B as O}from"./button-B_aprJyo.js";import{I as W}from"./input-DTbtaxsV.js";import Y from"./BreadcrumbsHeader-BOSIhs5m.js";import{t as g,T as J}from"./index-CH7DWExs.js";import"./table-qZFR-SzZ.js";import"./dropdown-menu-DFrz86N0.js";import P from"./DynamicTable-C_SQJSlc.js";import Z from"./ActionMenu-CazUS606.js";import{r as q,s as ee,t as te,u as se}from"./constants-DHCt9dPc.js";import"./react-datepicker-BTgyaUwu.js";import"./label-DokNcdmt.js";import oe from"./FillterToggle-cYp57TD0.js";import re from"./DynamicTableControls-CcWMFg7f.js";import le from"./DeleteConfirmationModal-DcMwm5QA.js";import{E as c}from"./ExportButton-CO89vrVN.js";import ae from"./SidebarModal-CSWrtQJc.js";import ne from"./PersonDetailContent-ghJKAROu.js";import{t as ie}from"./stringFormat-Dx_XIxG1.js";import{S as de}from"./search-BLeXCASV.js";import{H as ce}from"./house-plus-B9VTCG0U.js";import{E as me}from"./eye-CTOC_KFU.js";import{S as ue}from"./square-pen-7JDEATcf.js";import{T as pe}from"./trash-2-DGe7ZjJ3.js";import{U as he}from"./user-Chg4dNgg.js";import{M as xe}from"./map-pin-DjiyU5Lq.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./createLucideIcon-B4SoG9zf.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./useAppUrl-BIsbUUVL.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./breadcrumb-DsnADmME.js";import"./chevron-right-DYtVQaAj.js";import"./check-BsJSkZwI.js";import"./ellipsis-pjh7Fz_j.js";import"./index-BntGPR1O.js";import"./file-output-BVnTKX-L.js";import"./iconBase-DNpEM3Pe.js";import"./index-BDJITxkD.js";import"./index-BvB2ajn5.js";function gt({households:m,puroks:E,streets:D,queryParams:l}){const C=[{label:"Residents Information",showOnMobile:!1},{label:"Households",showOnMobile:!0}];l=l||{};const n=z().props,u=(n==null?void 0:n.success)??null,p=(n==null?void 0:n.error)??null,[j,T]=a.useState(l.name??""),[R,h]=a.useState(!1),[y,I]=a.useState(null),F=s=>{s.preventDefault(),x("name",j)},x=(s,t)=>{t&&t.trim()!==""?l[s]=t:delete l[s],l.page&&delete l.page,d.get(route("household.index",l))},M=(s,t)=>{if(t.key==="Enter")x(s,t.target.value);else return},i=[{key:"id",label:"ID"},{key:"name",label:"Household Head"},{key:"house_number",label:"House Number"},{key:"purok_number",label:"Purok"},{key:"street_name",label:"Street"},{key:"ownership_type",label:"Ownership Type"},{key:"housing_condition",label:"Housing Condition"},{key:"year_established",label:"Year Established"},{key:"house_structure",label:"House Structure"},{key:"number_of_rooms",label:"Number of Rooms"},{key:"number_of_floors",label:"Number of Floors"},{key:"number_of_occupants",label:"Number of Occupants"},{key:"actions",label:"Actions"}],[U,N]=a.useState(!1),[w,A]=a.useState(null),L=async s=>{try{const t=await axios.get(route("resident.showresident",s));A(t.data.resident)}catch(t){console.error("Error fetching resident details:",t),g.error("Failed to load resident details.",{description:t.message})}N(!0)},[f,_]=a.useState(i.map(s=>s.key));a.useEffect(()=>{f.length===0&&_(i.map(s=>s.key))},[]);const[fe,be]=a.useState(!0),[ge,je]=a.useState(!1),b=Object.entries(l||{}).some(([s,t])=>["purok","street","own_type","condition","structure"].includes(s)&&t&&t!=="");a.useEffect(()=>{b&&k(!0)},[b]);const[S,k]=a.useState(b),X={id:s=>{var t;return((t=s.household)==null?void 0:t.id)??e.jsx("span",{className:"text-gray-400 italic",children:"N/A"})},name:s=>{const t=s.resident;return t?e.jsxs("span",{className:"font-medium text-blue-600 hover:underline cursor-pointer",onClick:()=>L(t.id),children:[ie(`${t.firstname} ${t.middlename??""} ${t.lastname??""}`)," ",t.suffix??""]}):e.jsx("span",{className:"text-gray-400 italic",children:"No household head"})},house_number:s=>{var t,o;return(t=s.household)!=null&&t.house_number?e.jsx(H,{href:route("household.show",(o=s.household)==null?void 0:o.id),className:"text-gray-700 hover:text-blue-600 hover:underline font-medium",children:s.household.house_number}):e.jsx("span",{className:"text-gray-400 italic",children:"N/A"})},purok_number:s=>{var o,r;const t=(r=(o=s.household)==null?void 0:o.purok)==null?void 0:r.purok_number;return t?e.jsxs("span",{className:"bg-blue-100 text-blue-700 px-2 py-1 rounded-full text-xs font-medium",children:["Purok ",t]}):e.jsx("span",{className:"bg-gray-100 text-gray-500 px-2 py-1 rounded-full text-xs font-medium",children:"No Purok"})},street_name:s=>{var o,r;const t=(r=(o=s.household)==null?void 0:o.street)==null?void 0:r.street_name;return t?e.jsx("span",{className:"text-gray-700 font-medium",children:t}):e.jsxs("span",{className:"bg-gray-100 text-gray-500 text-xs px-2 py-1 rounded-full font-medium flex items-center gap-1",children:[e.jsx(xe,{size:14})," No street assigned"]})},ownership_type:s=>{var r;const t=(r=s.household)==null?void 0:r.ownership_type,o=se[t];return o?e.jsx("span",{className:"text-gray-700 font-medium",children:o}):e.jsx("span",{className:"text-gray-400 italic",children:"Unknown"})},housing_condition:s=>{var v;const t=(v=s.household)==null?void 0:v.housing_condition,o=te[t]??"bg-gray-100 text-gray-500",r=ee[t]??"Unknown";return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-lg ${o}`,children:r})},year_established:s=>{var t;return(t=s.household)!=null&&t.year_established?e.jsx("span",{className:"text-gray-700 font-medium",children:s.household.year_established}):e.jsx("span",{className:"text-gray-400 italic",children:"Unknown"})},house_structure:s=>{var r;const t=(r=s.household)==null?void 0:r.house_structure,o=q[t];return o?e.jsx("span",{className:"text-gray-700 font-medium",children:o}):e.jsx("span",{className:"text-gray-400 italic",children:"Unknown"})},number_of_rooms:s=>{var t;return((t=s.household)==null?void 0:t.number_of_rooms)??e.jsx("span",{className:"text-gray-400 italic",children:"N/A"})},number_of_floors:s=>{var t;return((t=s.household)==null?void 0:t.number_of_floors)??e.jsx("span",{className:"text-gray-400 italic",children:"N/A"})},number_of_occupants:s=>{var t,o,r;return e.jsxs("span",{className:"flex items-center gap-1 font-medium text-gray-700",children:[e.jsx("span",{className:"bg-green-100 text-green-700 text-xs px-2 py-0.5 rounded-full",children:((r=(o=(t=s==null?void 0:s.household)==null?void 0:t.residents_count)==null?void 0:o[0])==null?void 0:r.aggregate)??0}),e.jsx(he,{className:"h-4 w-4"})]})},actions:s=>e.jsx(Z,{actions:[{label:"View",icon:e.jsx(me,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>{var t;return d.visit(route("household.show",(t=s.household)==null?void 0:t.id))}},{label:"Edit",icon:e.jsx(ue,{className:"w-4 h-4 text-green-500"}),onClick:()=>{var t;return d.visit(route("household.edit",(t=s.household)==null?void 0:t.id))}},{label:"Delete",icon:e.jsx(pe,{className:"w-4 h-4 text-red-600"}),onClick:()=>{var t;return B((t=s.household)==null?void 0:t.id)}}]})},B=s=>{I(s),h(!0)},$=()=>{d.delete(route("household.destroy",y)),h(!1)};return a.useEffect(()=>{u&&g.success(u,{description:"Operation successful!",duration:3e3,closeButton:!0}),n.success=null},[u]),a.useEffect(()=>{p&&g.error(p,{description:"Operation failed!",duration:3e3,closeButton:!0}),n.error=null},[p]),e.jsxs(V,{children:[e.jsx(K,{title:"Households Dashboard"}),e.jsx(Y,{breadcrumbs:C}),e.jsx(J,{richColors:!0}),e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:e.jsx(G,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Households Records"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage all registered households in the barangay. Search, filter, or export data, and add new households for accurate community tracking."})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[e.jsx(re,{allColumns:i,visibleColumns:f,setVisibleColumns:_,showFilters:S,toggleShowFilters:()=>k(s=>!s)}),e.jsx(c,{url:"report/export-household-excel",queryParams:l,label:"Export Households as XLSX"}),e.jsx(c,{url:"report/export-household-pdf",queryParams:l,label:"Export Households as PDF",type:"pdf",totalRecords:m.total}),e.jsx(c,{url:"report/export-householdmembers-excel",queryParams:l,icon:e.jsx(Q,{}),label:"Export Household Members as XLSX"}),e.jsx(c,{url:"report/export-householdmembers-pdf",queryParams:l,label:"Export Households as PDF",type:"pdf",totalRecords:m.total})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:F,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(W,{type:"text",placeholder:"Search for Household Member Name",value:j,onChange:s=>T(s.target.value),onKeyDown:s=>M("name",s),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(O,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(de,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsx(H,{href:route("household.create"),children:e.jsxs("div",{className:"relative group z-50",children:[e.jsx(O,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Household"})]})})]})]}),S&&e.jsx(oe,{queryParams:l,searchFieldName:x,visibleFilters:["purok","street","own_type","condition","structure"],showFilters:!0,puroks:E,streets:D,clearRouteName:"household.index",clearRouteParams:{}}),e.jsx(P,{passedData:m,allColumns:i,columnRenderers:X,queryParams:l,visibleColumns:f,showTotal:!0}),e.jsx(le,{isOpen:R,onClose:()=>{h(!1)},onConfirm:$,residentId:y}),e.jsx(ae,{isOpen:U,onClose:()=>N(!1),title:"Resident Details",children:w&&e.jsx(ne,{person:w})})]})})})]})}export{gt as default};
