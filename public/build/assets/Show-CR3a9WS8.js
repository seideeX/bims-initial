import{K as le,r,j as t,L as ce,$ as me,S as f,a as P}from"./app-CDPwVV6Y.js";import pe from"./BreadcrumbsHeader-BOSIhs5m.js";import{S as de}from"./AdminLayout-BW3ywimG.js";import ue from"./DynamicTableControls-CcWMFg7f.js";import xe from"./DynamicTable-C_SQJSlc.js";import ye from"./FillterToggle-cYp57TD0.js";import ge from"./SidebarModal-CSWrtQJc.js";import be from"./PersonDetailContent-ghJKAROu.js";import{B as _}from"./button-B_aprJyo.js";import{I as fe}from"./input-DTbtaxsV.js";import{u as _e,s as we,r as he,v as w,w as Ee,x as Te,y as Ne,z as Se,M as U,m as je,H as M,n as F,o as ve,p as Oe,R as De,b as Re}from"./constants-DHCt9dPc.js";import ke from"./ActionMenu-CazUS606.js";import{u as He}from"./useAppUrl-BIsbUUVL.js";import{u as Ie}from"./useQuery-7q07Y6cu.js";import Ce from"./DeleteConfirmationModal-DcMwm5QA.js";import{t as X,T as Ae}from"./index-CH7DWExs.js";import{S as Le}from"./search-BLeXCASV.js";import{c as Pe}from"./createLucideIcon-B4SoG9zf.js";import{F as Ue}from"./file-text-DhLfxzDZ.js";import{E as Me}from"./eye-CTOC_KFU.js";import{S as Fe}from"./square-pen-7JDEATcf.js";import{X as Xe}from"./x-rg4AgZHH.js";import"./breadcrumb-DsnADmME.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-DYtVQaAj.js";import"./sidebar-BqlEtGlg.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./react-datepicker-BTgyaUwu.js";import"./index-BntGPR1O.js";import"./iconBase-DNpEM3Pe.js";import"./index-BDJITxkD.js";import"./index-BvB2ajn5.js";import"./ellipsis-pjh7Fz_j.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Be=Pe("share-2",$e);function Ut({household_details:s,household_members:$,queryParams:B=null}){var D,R,k,H,I,C,A,L;const W=[{label:"Residents Information",showOnMobile:!1},{label:"Households",href:route("household.index"),showOnMobile:!1},{label:"Household Details",showOnMobile:!0}],h=He(),o=le().props,p=(o==null?void 0:o.success)??null,d=(o==null?void 0:o.error)??null,{data:We,isLoading:qe,isError:ze}=Ie({queryKey:["head",s.id],queryFn:async()=>{const{data:e}=await P.get(`${h}/household/getlatesthead/${s.id}`);return(e==null?void 0:e.head)||null},enabled:!!(s!=null&&s.id),staleTime:1e3*60*5}),i=B||{},[E,q]=r.useState(i.name??""),z=e=>{e.preventDefault(),u("name",E)},u=(e,a)=>{a&&a.trim()!==""?i[e]=a:delete i[e],i.page&&delete i.page,f.get(route("household.show",{household:s.id,...i}))},V=(e,a)=>{a.key==="Enter"&&u(e,a.target.value)},m=[{key:"resident_id",label:"Resident ID"},{key:"name",label:"Resident Name"},{key:"sex",label:"Sex"},{key:"relationship_to_head",label:"Relationship to Head"},{key:"household_position",label:"Household Position"},{key:"employment_status",label:"Employment Status"},{key:"registered_voter",label:"Register Voter"},{key:"is_pwd",label:"Is PWD"},{key:"actions",label:"Actions"}],[Y,T]=r.useState(!1),[N,K]=r.useState(null),G=async e=>{try{const a=await P.get(`${h}/resident/showresident/${e}`);K(a.data.resident)}catch(a){console.error("Error fetching placeholders:",a)}T(!0)},[x,y]=r.useState(m.map(e=>e.key));r.useEffect(()=>{x.length===0&&y(m.map(e=>e.key))},[]);const[Q,Ve]=r.useState(!0),[S,J]=r.useState(!1),g=Object.entries(i||{}).some(([e,a])=>["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"].includes(e)&&a&&a!=="");r.useEffect(()=>{g&&v(!0)},[g]);const[j,v]=r.useState(g),Z=()=>{window.print()},ee=e=>{f.get(route("resident.edit",e))},[te,b]=r.useState(!1),[O,se]=r.useState(null),ae=e=>{se(e),b(!0)},re=()=>{f.get(route("household.remove",O)),b(!1)},ne=e=>{if(!e)return"Unknown";const a=new Date(e),n=new Date;let l=n.getFullYear()-a.getFullYear();const c=n.getMonth()-a.getMonth();return(c<0||c===0&&n.getDate()<a.getDate())&&l--,l},oe={resident_id:e=>e.resident.id,name:e=>`${e.resident.firstname} ${e.resident.middlename??""} ${e.resident.lastname??""} ${e.resident.suffix??""}`,sex:e=>{const a=e.resident.sex,n=De[a]??"Unknown",l=Re[a]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium ${l}`,children:n})},age:e=>{const a=ne(e.resident.birthdate);return typeof a!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"font-medium text-gray-800",children:[a," years old"]}),a>60&&t.jsx("span",{className:"text-xs text-rose-600 font-semibold",children:"Senior Citizen"})]})},relationship_to_head:e=>e.relationship_to_head in F?F[e.relationship_to_head]:t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),household_position:e=>e.household_position in M?M[e.household_position]:t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),employment_status:e=>je[e.resident.employment_status],registered_voter:e=>{var c;const a=((c=e.resident)==null?void 0:c.registered_voter)??0,n=ve[a]??"Unknown",l=Oe[a]??"p-1 bg-gray-300 text-black rounded-lg";return t.jsx("span",{className:l,children:n})},is_pwd:e=>(e==null?void 0:e.is_pwd)in U?U[e.is_pwd]:t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),actions:e=>t.jsx(ke,{actions:[{label:"View",icon:t.jsx(Me,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>G(e.resident_id)},{label:"Edit",icon:t.jsx(Fe,{className:"w-4 h-4 text-green-500"}),onClick:()=>ee(e.resident_id)},{label:"Remove",icon:t.jsx(Xe,{className:"w-4 h-4 text-red-600"}),onClick:()=>ae(e.resident_id)}]})},ie=e=>{const a=`/export-household-rbi/${e}`;window.open(a,"_blank")};return r.useEffect(()=>{p&&X.success(p,{description:"Operation successful!",duration:3e3,closeButton:!0}),o.success=null},[p]),r.useEffect(()=>{d&&X.error(d,{description:"Operation failed!",duration:3e3,closeButton:!0}),o.error=null},[d]),t.jsxs(de,{children:[t.jsx(ce,{title:"Family"}),t.jsx(Ae,{richColors:!0}),t.jsx(pe,{breadcrumbs:W}),t.jsxs("div",{className:"bg-white shadow-md rounded-lg m-5 border border-gray-200",children:[t.jsxs("div",{className:"px-4 py-4 border-b bg-gray-100 rounded-t-lg",children:[t.jsxs("h2",{className:"text-2xl font-semibold text-gray-800",children:["House #",s.house_number]}),t.jsxs("p",{className:"text-sm text-gray-600",children:[((R=(D=s==null?void 0:s.purok)==null?void 0:D.barangay)==null?void 0:R.barangay_name)||""," ","• Purok ",((k=s==null?void 0:s.purok)==null?void 0:k.purok_number)||""," •"," ",((H=s==null?void 0:s.street)==null?void 0:H.street_name)||""," Street"]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-6",children:[{label:"Ownership Type",value:_e[s.ownership_type]},{label:"Housing Condition",value:we[s.housing_condition]},{label:"Year Established",value:s.year_established},{label:"House Structure",value:he[s.house_structure]},{label:"Bath & Wash Area",value:Array.isArray(s.bath_and_wash_area)?s.bath_and_wash_area.map(e=>w[e]||e).join(", "):typeof s.bath_and_wash_area=="object"?Object.values(s.bath_and_wash_area).map(e=>w[e]||e).join(", "):w[s.bath_and_wash_area]||s.bath_and_wash_area},{label:"Rooms",value:s.number_of_rooms},{label:"Floors",value:s.number_of_floors},{label:"Coordinates",value:`${s.latitude}, ${s.longitude}`},{label:"Toilet Types",value:((I=s.toilets)==null?void 0:I.length)>0?s.toilets.map(e=>Ee[e.toilet_type]||e.toilet_type).join(", "):"None"},{label:"Waste Management Types",value:((C=s.waste_management_types)==null?void 0:C.length)>0?s.waste_management_types.map(e=>Te[e.waste_management_type]||e.waste_management_type).join(", "):"None"},{label:"Water Source Types",value:((A=s.water_source_types)==null?void 0:A.length)>0?s.water_source_types.map(e=>Ne[e.water_source_type]||e.water_source_type).join(", "):"None"},{label:"Electricity Types",value:((L=s.electricity_types)==null?void 0:L.length)>0?s.electricity_types.map(e=>Se[e.electricity_type]||e.electricity_type).join(", "):"None"}].map(({label:e,value:a},n)=>t.jsxs("div",{className:"flex justify-between border-b pb-2",children:[t.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[e,":"]}),t.jsx("span",{className:"text-sm text-gray-900 text-right max-w-[60%]",children:a||"—"})]},n))})]}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(ue,{allColumns:m,visibleColumns:x,setVisibleColumns:y,onPrint:Z,showFilters:j,toggleShowFilters:()=>v(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:z,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(fe,{type:"text",placeholder:"Search for Household Member Name",value:E,onChange:e=>q(e.target.value),onKeyDown:e=>V("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(Le,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),t.jsx(me,{href:route("family.create"),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(Be,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Relationship"})]})}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-red-300 text-red-700 hover:bg-red-600 hover:text-white",onClick:()=>ie(s.id),children:t.jsx(Ue,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-red-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Export RBI Form A"})]})]})]}),j&&t.jsx(ye,{queryParams:i,searchFieldName:u,visibleFilters:["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"],showFilters:!0,clearRouteName:"household.show",clearRouteParams:{household:s.id}}),t.jsx(xe,{passedData:$,columnRenderers:oe,allColumns:m,is_paginated:Q,toggleShowAll:()=>J(!S),showAll:S,visibleColumns:x,setVisibleColumns:y})]})})}),t.jsx(ge,{isOpen:Y,onClose:()=>T(!1),title:"Resident Details",children:N&&t.jsx(be,{person:N})}),t.jsx(Ce,{isOpen:te,onClose:()=>{b(!1)},onConfirm:re,residentId:O,title:"Confirm Removal",message:"Are you sure you want to remove resident from this household? This action cannot be undone.",buttonLabel:"I UNDERSTAND, REMOVE"})]})}export{Ut as default};
