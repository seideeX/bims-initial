import{K as ce,r as l,m as de,j as s,L as me,S as T,a as ue}from"./app-CDPwVV6Y.js";import{S as pe}from"./AdminLayout-BW3ywimG.js";import{B as I}from"./button-B_aprJyo.js";import{I as he}from"./input-DTbtaxsV.js";import xe from"./BreadcrumbsHeader-BOSIhs5m.js";import{t as _,T as fe}from"./index-CH7DWExs.js";import ve from"./DynamicTable-C_SQJSlc.js";import be from"./ActionMenu-CazUS606.js";import{a5 as ge,a6 as _e,ad as ye}from"./constants-DHCt9dPc.js";import je from"./SidebarModal-CSWrtQJc.js";import Se from"./DynamicTableControls-CcWMFg7f.js";import we from"./FillterToggle-cYp57TD0.js";import{u as Ne}from"./handleResidentChange-yybasKmi.js";import{u as ke}from"./useAppUrl-BIsbUUVL.js";import Ee from"./DeleteConfirmationModal-DcMwm5QA.js";import Ce from"./VehicleForm-DHG4xshI.js";import{E as A}from"./ExportButton-CO89vrVN.js";import{c as De}from"./createLucideIcon-B4SoG9zf.js";import{S as Ve}from"./search-BLeXCASV.js";import{L as Te}from"./list-plus-D4__nvo2.js";import{S as Ie}from"./square-pen-7JDEATcf.js";import{T as Ae}from"./trash-2-DGe7ZjJ3.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./chevron-right-DYtVQaAj.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./breadcrumb-DsnADmME.js";import"./ellipsis-pjh7Fz_j.js";import"./react-datepicker-BTgyaUwu.js";import"./index-BntGPR1O.js";import"./index-D4O4cOmu.js";import"./iconBase-DNpEM3Pe.js";import"./DropdownInputField-BmM-TOT_.js";import"./InputError-CsvCol3W.js";import"./InputField-D_ZI8EKx.js";import"./InputLabel-C3y8TkvV.js";import"./RadioGroup-K1vYBuUY.js";import"./rotate-ccw-D-jj88si.js";import"./move-right-OicHD8ux.js";import"./file-output-BVnTKX-L.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],Me=De("car",Le);function Fs({vehicles:L,vehicle_types:M,puroks:O,queryParams:P,residents:y}){const i=P||{},R=[{label:"Residents Information",showOnMobile:!1},{label:"Vehicles",showOnMobile:!0}],F=ke(),o=ce().props,d=(o==null?void 0:o.success)??null,m=(o==null?void 0:o.error)??null,[$,u]=l.useState(null),[p,j]=l.useState(null),[U,h]=l.useState(!1),[S,H]=l.useState(null),[w,B]=l.useState(i.name??""),[q,x]=l.useState(!1),{data:n,setData:c,post:N,errors:X,reset:k,clearErrors:z}=de({resident_id:null,resident_name:"",resident_image:null,birthdate:null,purok_number:null,has_vehicle:null,vehicles:[[]],vehicle_id:null,_method:void 0}),K=Ne(y,c),G=(e,t,r,a)=>{const g=[...n[a]||[]];g[t]={...g[t],[r]:e.target.value},c(a,g)},Y=e=>{e.preventDefault(),f("name",w)},f=(e,t)=>{t&&t.trim()!==""?i[e]=t:delete i[e],i.page&&delete i.page,T.get(route("vehicle.index",i))},Q=(e,t)=>{t.key==="Enter"&&f(e,t.target.value)},J=()=>{c("vehicles",[...n.vehicles||[],{}])},W=e=>{const t=[...n.vehicles||[]];t.splice(e,1),c("vehicles",t),_.warning("Vehicle removed.",{duration:2e3})},v=[{key:"id",label:"Vehicle ID"},{key:"name",label:"Owner Name"},{key:"vehicle_type",label:"Vehicle Type"},{key:"vehicle_class",label:"Class"},{key:"usage_status",label:"Usage"},{key:"is_registered",label:"Is Registered?"},{key:"purok_number",label:"Purok Number"},{key:"actions",label:"Actions"}],[E,Z]=l.useState(v.map(e=>e.key)),[Oe,Pe]=l.useState(!0),[Re,Fe]=l.useState(!1),b=Object.entries(i||{}).some(([e,t])=>["purok","v_type","v_class","usage"].includes(e)&&t&&t!==""),[C,D]=l.useState(b);l.useEffect(()=>{D(b)},[b]);const ee=()=>D(e=>!e),se={id:e=>{var t,r;return((r=(t=e.vehicles)==null?void 0:t[0])==null?void 0:r.id)??"—"},name:e=>s.jsxs("span",{children:[e.firstname," ",e.middlename??""," ",e.lastname," ",e.suffix??""]}),vehicle_type:e=>{var t,r;return s.jsx("span",{className:"capitalize",children:((r=(t=e.vehicles)==null?void 0:t[0])==null?void 0:r.vehicle_type)??"—"})},vehicle_class:e=>{var t;return(t=e.vehicles)!=null&&t[0]?ge[e.vehicles[0].vehicle_class]:"—"},usage_status:e=>{var a;const t=(a=e.vehicles)==null?void 0:a[0];if(!t)return"—";const r=_e[t.usage_status];return s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${ye[t.usage_status]}`,children:r})},is_registered:e=>{var r,a;const t=(a=(r=e.vehicles)==null?void 0:r[0])==null?void 0:a.is_registered;return t===void 0?"—":t?s.jsx("span",{className:"text-green-600 font-medium",children:"Yes"}):s.jsx("span",{className:"text-gray-500 font-medium",children:"No"})},purok_number:e=>e.purok_number,actions:e=>{var r,a;const t=(a=(r=e.vehicles)==null?void 0:r[0])==null?void 0:a.id;return t?s.jsx(be,{actions:[{label:"Edit",icon:s.jsx(Ie,{className:"w-4 h-4 text-green-500"}),onClick:()=>ae(t)},{label:"Delete",icon:s.jsx(Ae,{className:"w-4 h-4 text-red-600"}),onClick:()=>oe(t)}]}):null}},te=()=>{u("add"),x(!0)},re=y.map(e=>({label:`${e.firstname} ${e.middlename} ${e.lastname} ${e.suffix??""}`,value:e.id.toString()})),le=e=>{e.preventDefault(),N(route("vehicle.store"),{onError:t=>console.log(t)})},ie=e=>{e.preventDefault(),N(route("vehicle.update",n.vehicle_id),{onError:t=>console.log(t)})},V=()=>{x(!1),u(null),j(null),k(),z()},ae=async e=>{u("add");try{const r=(await ue.get(`${F}/vehicle/details/${e}`)).data.vehicle;j(r),c({resident_id:r.resident.id,resident_name:`${r.resident.firstname} ${r.resident.middlename??""} ${r.resident.lastname}`,resident_image:r.resident.image??null,birthdate:r.resident.birthdate??null,purok_number:r.resident.purok_number??null,vehicles:[{usage_status:r.usage_status||"",vehicle_class:r.vehicle_class||"",vehicle_status:r.vehicle_status||"",vehicle_type:r.vehicle_type||"",is_registered:r.is_registered?r.is_registered.toString():""}],_method:"PUT",vehicle_id:r.id}),x(!0)}catch(t){console.error("Error fetching occupation details:",t)}},oe=e=>{H(e),h(!0)},ne=()=>{T.delete(route("vehicle.destroy",S)),h(!1)};return l.useEffect(()=>{d&&(V(),_.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0})),o.success=null},[d]),l.useEffect(()=>{m&&_.error(m,{description:"Operation failed!",duration:3e3,closeButton:!0}),o.error=null},[m]),s.jsxs(pe,{children:[s.jsx(me,{title:"Vehicles"}),s.jsxs("div",{children:[s.jsx(fe,{richColors:!0}),s.jsx(xe,{breadcrumbs:R}),s.jsx("div",{className:"p-2 md:p-4",children:s.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:s.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:s.jsx(Me,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Vehicle Records"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Manage community vehicle data including ownership, type, and usage. Use the tools below to search, filter, or export vehicle records."})]})]})}),s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[s.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[s.jsx(Se,{allColumns:v,visibleColumns:E,setVisibleColumns:Z,showFilters:C,toggleShowFilters:ee}),s.jsx(A,{url:"report/export-vehicles-excel",queryParams:i,label:"Export Vehicles as XLSX"}),s.jsx(A,{url:"report/export-vehicle-pdf",queryParams:i,label:"Export Households as PDF",type:"pdf"})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[s.jsxs("form",{onSubmit:Y,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[s.jsx(he,{type:"text",placeholder:"Search Owners Name",value:w,onChange:e=>B(e.target.value),onKeyDown:e=>Q("name",e),className:"w-full"}),s.jsx("div",{className:"relative group z-50",children:s.jsx(I,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:s.jsx(Ve,{})})})]}),s.jsx("div",{className:"relative group z-50",children:s.jsx(I,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",onClick:te,type:"button",children:s.jsx(Te,{})})})]})]}),C&&s.jsx(we,{queryParams:i,searchFieldName:f,visibleFilters:["purok","v_type","v_class","usage"],vehicle_types:M,puroks:O,showFilters:!0,clearRouteName:"vehicle.index",clearRouteParams:{}}),s.jsx(ve,{passedData:L,allColumns:v,columnRenderers:se,queryParams:i,visibleColumns:E,showTotal:!0}),s.jsx(je,{isOpen:q,onClose:V,title:p?"Edit Vehicle Details":"Add Vehicles",children:$==="add"&&s.jsx("div",{className:"w-full rounded-xl border border-white/20 bg-white/10 backdrop-blur-md shadow-lg text-sm text-black p-4 space-y-4",children:s.jsx(Ce,{data:n,errors:X,vehicleDetails:p,residentsList:re,handleResidentChange:K,handleArrayValues:G,addVehicle:J,removeVehicle:W,reset:k,onSubmit:p?ie:le})})}),s.jsx(Ee,{isOpen:U,onClose:()=>{h(!1)},onConfirm:ne,residentId:S})]})})})]})]})}export{Fs as default};
