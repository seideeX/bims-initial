import{K as W,r as o,j as e,L as V,$ as v,S as m}from"./app-CDPwVV6Y.js";import{S as $,H as Q}from"./AdminLayout-BW3ywimG.js";import{B as _}from"./button-B_aprJyo.js";import{I as G}from"./input-DTbtaxsV.js";import J from"./BreadcrumbsHeader-BOSIhs5m.js";import{t as k,T as U}from"./index-CH7DWExs.js";import"./table-qZFR-SzZ.js";import"./dropdown-menu-DFrz86N0.js";import X from"./DynamicTable-C_SQJSlc.js";import Y from"./ActionMenu-CazUS606.js";import"./react-datepicker-BTgyaUwu.js";import"./label-DokNcdmt.js";import Z from"./FillterToggle-cYp57TD0.js";import P from"./DynamicTableControls-CcWMFg7f.js";import q from"./DeleteConfirmationModal-DcMwm5QA.js";import{E as ee}from"./ExportButton-CO89vrVN.js";import{S as te}from"./search-BLeXCASV.js";import{H as se}from"./house-plus-B9VTCG0U.js";import{E as ae}from"./eye-CTOC_KFU.js";import{S as ie}from"./square-pen-7JDEATcf.js";import{T as re}from"./trash-2-DGe7ZjJ3.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./createLucideIcon-B4SoG9zf.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./useAppUrl-BIsbUUVL.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./breadcrumb-DsnADmME.js";import"./chevron-right-DYtVQaAj.js";import"./check-BsJSkZwI.js";import"./ellipsis-pjh7Fz_j.js";import"./index-BntGPR1O.js";import"./constants-DHCt9dPc.js";import"./file-output-BVnTKX-L.js";function et({households:y,puroks:S,queryParams:l,toiletTypes:D,electricityTypes:C,waterSourceTypes:E,wasteManagementTypes:H,internetTypes:T,bathTypes:z}){const O=[{label:"Residents Information",showOnMobile:!1},{label:"Households",showOnMobile:!0}];l=l||{};const n=W().props,d=(n==null?void 0:n.success)??null,p=(n==null?void 0:n.error)??null,[b,A]=o.useState(l.name??""),[F,u]=o.useState(!1),[g,I]=o.useState(null),B=t=>{t.preventDefault(),x("name",b)},x=(t,s)=>{s&&s.trim()!==""?l[t]=s:delete l[t],l.page&&delete l.page,m.get(route("household.overview",l))},M=(t,s)=>{if(s.key==="Enter")x(t,s.target.value);else return},c=[{key:"id",label:"ID"},{key:"house_number",label:"House Number"},{key:"bath_and_wash_area",label:"Bath & Wash Area"},{key:"toilets",label:"Toilet Type(s)"},{key:"electricity_types",label:"Electricity Source(s)"},{key:"water_source_types",label:"Water Source(s)"},{key:"waste_management_types",label:"Waste Management Type(s)"},{key:"livestocks_text",label:"Livestock Summary"},{key:"pets_text",label:"Pet Summary"},{key:"internet_accessibility",label:"Internet Accessibility"},{key:"purok",label:"Purok Number"},{key:"actions",label:"Actions"}],[h,j]=o.useState(c.map(t=>t.key));o.useEffect(()=>{h.length===0&&j(c.map(t=>t.key))},[]);const[le,oe]=o.useState(!0),[ne,ce]=o.useState(!1),f=Object.entries(l||{}).some(([t,s])=>["purok","toilet","electricity","water","waste","internet","bath"].includes(t)&&s&&s!=="");o.useEffect(()=>{f&&w(!0)},[f]);const[N,w]=o.useState(f),R={id:t=>e.jsx("span",{className:"text-gray-800 font-medium",children:t.id??"Not specified"}),house_number:t=>e.jsx(v,{href:route("household.show",{household:t.id}),className:"text-blue-600 hover:underline font-semibold",children:t.house_number??e.jsx("span",{className:"text-gray-400 font-normal italic",children:"Not specified"})}),bath_and_wash_area:t=>t.bath_and_wash_area?e.jsx("span",{className:"text-gray-800 capitalize font-medium",children:t.bath_and_wash_area}):e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),toilets:t=>{const s=t.toilets??[];return s.length?e.jsx("ul",{className:"text-gray-800 space-y-0.5",children:s.map((r,a)=>e.jsx("li",{className:"capitalize",children:e.jsx("span",{className:"font-medium",children:r.toilet_type.replace(/_/g," ")})},a))}):e.jsx("span",{className:"text-gray-400 italic",children:"No toilet data"})},electricity_types:t=>{const s=t.electricity_types??[];return s.length?e.jsx("ul",{className:"text-gray-800 space-y-0.5",children:s.map((r,a)=>e.jsx("li",{className:"capitalize",children:e.jsx("span",{className:"font-medium",children:r.electricity_type.replace(/_/g," ")})},a))}):e.jsx("span",{className:"text-gray-400 italic",children:"No electricity data"})},water_source_types:t=>{const s=t.water_source_types??[];return s.length?e.jsx("ul",{className:"text-gray-800 space-y-0.5",children:s.map((r,a)=>e.jsx("li",{className:"capitalize",children:e.jsx("span",{className:"font-medium",children:r.water_source_type.replace(/_/g," ")})},a))}):e.jsx("span",{className:"text-gray-400 italic",children:"No water source data"})},waste_management_types:t=>{const s=t.waste_management_types??[];return s.length?e.jsx("ul",{className:"text-gray-800 space-y-0.5",children:s.map((r,a)=>e.jsx("li",{className:"capitalize",children:e.jsx("span",{className:"font-medium",children:r.waste_management_type.replace(/_/g," ")})},a))}):e.jsx("span",{className:"text-gray-400 italic",children:"No waste data"})},livestocks_text:t=>{const s=t.livestocks??[];if(s.length===0)return e.jsx("span",{className:"text-gray-400 italic",children:"No livestock recorded"});const r=s.reduce((a,i)=>(a[i.livestock_type]=(a[i.livestock_type]??0)+(i.quantity??1),a),{});return e.jsx("ul",{className:"space-y-0.5 text-gray-800",children:Object.entries(r).map(([a,i])=>e.jsxs("li",{children:[e.jsxs("span",{className:"capitalize font-medium",children:[a.replace(/_/g," "),":"]})," ",e.jsx("span",{className:"text-gray-700 font-semibold",children:i})]},a))})},pets_text:t=>{const s=t.pets??[];if(s.length===0)return e.jsx("span",{className:"text-gray-400 italic",children:"No pets recorded"});const r=s.reduce((a,i)=>(a[i.pet_type]||(a[i.pet_type]={total:0,vaccinated:0}),a[i.pet_type].total+=1,i.is_vaccinated&&(a[i.pet_type].vaccinated+=1),a),{});return e.jsx("ul",{className:"space-y-0.5 text-gray-800",children:Object.entries(r).map(([a,i])=>e.jsxs("li",{children:[e.jsxs("span",{className:"capitalize font-medium",children:[a.replace(/_/g," "),":"]})," ",e.jsx("span",{className:"text-gray-700 font-semibold",children:i.total})," ",e.jsxs("span",{className:"text-gray-500",children:["(",i.vaccinated,"/",i.total," vaccinated)"]})]},a))})},internet_accessibility:t=>{const s=t.internet_accessibility??[];return s.length===0?e.jsx("span",{className:"text-gray-400 italic",children:"No internet information"}):e.jsx("ul",{className:"text-gray-800 space-y-0.5",children:s.map((r,a)=>e.jsxs("li",{children:[e.jsxs("span",{className:"capitalize font-medium",children:[r.connection_type??"Not specified",":"]})," ",e.jsx("span",{className:"text-gray-700 font-semibold",children:r.provider??"Not provided"})]},a))})},purok:t=>{var s;return(s=t.purok)!=null&&s.purok_number?e.jsx("span",{className:"text-gray-800 font-medium",children:t.purok.purok_number}):e.jsx("span",{className:"text-gray-400 italic",children:"Not specified"})},actions:t=>e.jsx(Y,{actions:[{label:"View",icon:e.jsx(ae,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>m.visit(route("household.show",{household:t.id}))},{label:"Edit",icon:e.jsx(ie,{className:"w-4 h-4 text-green-500"}),onClick:()=>m.visit(route("household.edit",{household:t.id}))},{label:"Delete",icon:e.jsx(re,{className:"w-4 h-4 text-red-600"}),onClick:()=>K(t.id)}]})},K=t=>{I(t),u(!0)},L=()=>{m.delete(route("household.destroy",g)),u(!1)};return o.useEffect(()=>{d&&k.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0}),n.success=null},[d]),o.useEffect(()=>{p&&k.error(p,{description:"Operation failed!",duration:3e3,closeButton:!0}),n.error=null},[p]),e.jsxs($,{children:[e.jsx(V,{title:"Households Dashboard"}),e.jsx(J,{breadcrumbs:O}),e.jsx(U,{richColors:!0}),e.jsx("div",{className:"pt-4",children:e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-full",children:e.jsx(Q,{className:"w-6 h-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Household Data Overview"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Review and manage comprehensive information about households within the barangay. Access records, apply filters, and maintain accurate data for effective community planning."})]})]})}),e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-wrap",children:[e.jsx(P,{allColumns:c,visibleColumns:h,setVisibleColumns:j,showFilters:N,toggleShowFilters:()=>w(t=>!t)}),e.jsx(ee,{url:"report/export-householdoverview-pdf",queryParams:l,label:"Export Households Services as PDF",type:"pdf",totalRecords:y.total})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:B,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(G,{type:"text",placeholder:"Search for Household Number",value:b,onChange:t=>A(t.target.value),onKeyDown:t=>M("name",t),className:"w-full"}),e.jsxs("div",{className:"relative group z-50",children:[e.jsx(_,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(te,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsx(v,{href:route("household.create"),children:e.jsxs("div",{className:"relative group z-50",children:[e.jsx(_,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add Household"})]})})]})]}),N&&e.jsx(Z,{queryParams:l,searchFieldName:x,visibleFilters:["purok","toilet","electricity","water","waste","internet","bath"],showFilters:!0,puroks:S,toiletTypes:D,electricityTypes:C,wasteManagementTypes:H,waterSourceTypes:E,internetTypes:T,bathTypes:z,clearRouteName:"household.overview",clearRouteParams:{}}),e.jsx(X,{passedData:y,allColumns:c,columnRenderers:R,queryParams:l,visibleColumns:h,showTotal:!0}),e.jsx(q,{isOpen:F,onClose:()=>{u(!1)},onConfirm:L,residentId:g})]})})})]})}export{et as default};
