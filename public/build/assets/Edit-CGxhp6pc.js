import{r as f,m as to,j as u,K as po,L as fo}from"./app-CDPwVV6Y.js";import go from"./BreadcrumbsHeader-BOSIhs5m.js";import"./index-Dsz93ONd.js";import{B as bo}from"./button-B_aprJyo.js";import{S as no,a as ro,b as yo}from"./Section3-DaNVZLa2.js";import{S as vo}from"./Section4-BtQ1VJZU.js";import{S as xo}from"./Section5-Nqid335z.js";import{C as so}from"./Checkbox-Cox4_RpR.js";import{t as uo,T as wo}from"./index-CH7DWExs.js";import"./switch-Zowgx48p.js";import{S as So}from"./AdminLayout-BW3ywimG.js";import"./breadcrumb-DsnADmME.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-DYtVQaAj.js";import"./createLucideIcon-B4SoG9zf.js";import"./sidebar-BqlEtGlg.js";import"./input-DTbtaxsV.js";import"./index-8Tef56KC.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./tooltip-10O7WS77.js";import"./InputField-D_ZI8EKx.js";import"./InputError-CsvCol3W.js";import"./InputLabel-C3y8TkvV.js";import"./DropdownInputField-BmM-TOT_.js";import"./RadioGroup-K1vYBuUY.js";import"./SelectField-DIeNwIQe.js";import"./YearDropdown-Cu5CjLYl.js";import"./index-D4O4cOmu.js";import"./iconBase-DNpEM3Pe.js";import"./stringFormat-Dx_XIxG1.js";import"./useAppUrl-BIsbUUVL.js";import"./index-BntGPR1O.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./DeleteConfirmationModal-DcMwm5QA.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";const jo=({puroks:v,occupationTypes:x=null,streets:s=null,households:t=null,barangays:y=null,resident:o})=>{var S,j,k,N,B,E,z,A,M,C,D,I,R,O,P,T,q,F,L,H,Y,G,K,U,V,J,Q,W,X,Z,$,e;const g=f.useCallback(a=>{if(!a)return 0;const m=new Date(a),c=new Date;let i=c.getFullYear()-m.getFullYear();const h=c.getMonth()-m.getMonth();return(h<0||h===0&&c.getDate()<m.getDate())&&i--,i},[]);Object.entries(y).map(([a,m])=>({label:m,value:a}));const b=t==null?void 0:t.map(a=>({label:a.household.house_number.toString().padStart(4,"0")+" || "+a.lastname+"'s Residence",value:a.household.id.toString()})),p={resident_image:null,lastname:(o==null?void 0:o.lastname)||"",firstname:(o==null?void 0:o.firstname)||"",middlename:(o==null?void 0:o.middlename)||"",suffix:(o==null?void 0:o.suffix)||"",birthdate:(o==null?void 0:o.birthdate)||"",age:o?g(o.birthdate):0,birthplace:(o==null?void 0:o.birthplace)||"",civil_status:(o==null?void 0:o.civil_status)||"",sex:o!=null&&o.sex?o==null?void 0:o.sex.toString():"",gender:(o==null?void 0:o.gender)||"",maiden_name:(o==null?void 0:o.maiden_name)||"",citizenship:(o==null?void 0:o.citizenship)||"",religion:(o==null?void 0:o.religion)||"",ethnicity:(o==null?void 0:o.ethnicity)||"",employment_status:(o==null?void 0:o.employment_status)||"",contactNumber:(o==null?void 0:o.contact_number)||"",email:(o==null?void 0:o.email)||"",residency_type:(o==null?void 0:o.residency_type)||"",residency_date:(o==null?void 0:o.residency_date)||"",is_household_head:(o==null?void 0:o.is_household_head)||0,is_family_head:(o==null?void 0:o.is_family_head)||0,verified:0,purok_number:(o==null?void 0:o.purok_number)||null,purok_id:((S=o==null?void 0:o.street)==null?void 0:S.purok_id)||null,street_id:((j=o==null?void 0:o.street)==null?void 0:j.id)||null,street_name:((k=o==null?void 0:o.street)==null?void 0:k.street_name)||"",subdivision:((N=o==null?void 0:o.household)==null?void 0:N.subdivision)||"",housenumber:(()=>{const a=b.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.value)||""})(),housenumber_label:(()=>{const a=b.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.label)||""})(),household_id:(()=>{const a=b.find(m=>{var c;return m.value===String((c=o==null?void 0:o.household)==null?void 0:c.id)});return(a==null?void 0:a.value)||""})(),is_4ps_beneficiary:((B=o==null?void 0:o.social_welfare_profile)==null?void 0:B.is_4ps_beneficiary)!=null?o.social_welfare_profile.is_4ps_beneficiary.toString():null,philsys_card_number:((E=o==null?void 0:o.social_welfare_profile)==null?void 0:E.philsys_card_no)||"",is_solo_parent:((z=o==null?void 0:o.social_welfare_profile)==null?void 0:z.is_solo_parent)!=null?o.social_welfare_profile.is_solo_parent.toString():null,solo_parent_id_number:((A=o==null?void 0:o.social_welfare_profile)==null?void 0:A.solo_parent_id_number)||"",voter_id_number:((M=o==null?void 0:o.voting_information)==null?void 0:M.voter_id_number)||"",voting_status:((C=o==null?void 0:o.voting_information)==null?void 0:C.voting_status)||"",registered_voter:o!=null&&o.registered_voter?o==null?void 0:o.registered_voter.toString():"0",registered_barangay:((I=(D=o==null?void 0:o.voting_information)==null?void 0:D.registered_barangay_id)==null?void 0:I.toString())||null,has_vehicle:(R=o==null?void 0:o.vehicles)!=null&&R.length?1:0,vehicles:(o==null?void 0:o.vehicles)||[],educational_histories:Array.isArray(o==null?void 0:o.educational_histories)&&o.educational_histories.length?o.educational_histories.map(({educational_attainment:a,...m})=>({...m,education:a||""})):[],occupations:Array.isArray(o==null?void 0:o.occupations)&&o.occupations.length?o.occupations.map(a=>({...a,income:a.monthly_income||0,income_frequency:a.income_frequency||"monthly",work_arrangement:a.work_arrangement||""})):[],weight_kg:((O=o==null?void 0:o.medical_information)==null?void 0:O.weight_kg)||0,height_cm:((P=o==null?void 0:o.medical_information)==null?void 0:P.height_cm)||0,bmi:((T=o==null?void 0:o.medical_information)==null?void 0:T.bmi)||0,nutrition_status:((q=o==null?void 0:o.medical_information)==null?void 0:q.nutrition_status)||"",emergency_contact_name:((F=o==null?void 0:o.medical_information)==null?void 0:F.emergency_contact_name)||"",emergency_contact_number:((L=o==null?void 0:o.medical_information)==null?void 0:L.emergency_contact_number)||null,emergency_contact_relationship:((H=o==null?void 0:o.medical_information)==null?void 0:H.emergency_contact_relationship)||"",blood_type:((Y=o==null?void 0:o.medical_information)==null?void 0:Y.blood_type)||null,has_philhealth:((G=o==null?void 0:o.medical_information)==null?void 0:G.has_philhealth)!=null?o.medical_information.has_philhealth.toString():null,philhealth_number:((K=o==null?void 0:o.medical_information)==null?void 0:K.philhealth_id_number)||"",is_pwd:(o==null?void 0:o.is_pwd)!=null?o.is_pwd.toString():null,pwd_id_number:((U=o==null?void 0:o.medical_information)==null?void 0:U.pwd_id_number)||"",is_alcohol_user:((V=o==null?void 0:o.medical_information)==null?void 0:V.is_alcohol_user)!=null?o.medical_information.is_alcohol_user.toString():null,is_smoker:((J=o==null?void 0:o.medical_information)==null?void 0:J.is_smoker)!=null?o.medical_information.is_smoker.toString():null,livelihoods:Array.isArray(o==null?void 0:o.livelihoods)&&o.livelihoods.length?o.livelihoods.map(a=>({...a,income:a.income||a.monthly_income||0,income_frequency:a.income_frequency||"monthly",status:a.status||"active",is_main_livelihood:a.is_main_livelihood!=null?a.is_main_livelihood.toString():""})):[],disabilities:(o==null?void 0:o.disabilities)||[],relationship_to_head:((Q=o==null?void 0:o.latestHouseholdResident)==null?void 0:Q.relationship_to_head)||"",household_position:((W=o==null?void 0:o.latestHouseholdResident)==null?void 0:W.household_position)||"",name_of_head:"",is_pensioner:((X=o==null?void 0:o.senior_citizen)==null?void 0:X.is_pensioner)||"",living_alone:((Z=o==null?void 0:o.senior_citizen)==null?void 0:Z.living_alone)!=null?o.senior_citizen.living_alone.toString():null,osca_id_number:(($=o==null?void 0:o.senior_citizen)==null?void 0:$.osca_id_number)!=null?o.senior_citizen.osca_id_number.toString():null,pension_type:((e=o==null?void 0:o.senior_citizen)==null?void 0:e.pension_type)||"",new_housenumber:"",_method:"PUT"},{data:l,setData:_,post:_o,errors:n}=to({...p}),co=o!=null&&o.resident_picture_path?"/storage/"+o.resident_picture_path:null,io=["female"].includes(l.gender)&&["married","widowed","Separated"].includes(l.civil_status);f.useMemo(()=>(t||[]).reduce((a,m)=>(a[String(m.household.id)]=m,a),{}),[t]);const w=f.useCallback((a,m,c,i)=>{const h=[...l[i]||[]];h[m]={...h[m],[c]:a.target.value},_(i,h)},[l,_]);f.useEffect(()=>{l.birthdate&&_("age",g(l.birthdate))},[l.birthdate,g,_]),f.useEffect(()=>{if(l.weight_kg>0&&l.height_cm>0){const a=l.height_cm/100,m=l.weight_kg/(a*a),c=parseFloat(m.toFixed(2));let i="";m<16?i="severly_underweight":m<18.5?i="underweight":m<25?i="normal":m<30?i="overweight":i="obese",_(h=>({...h,bmi:c,nutrition_status:i}))}else _(a=>({...a,bmi:0,nutrition_status:""}))},[l.weight_kg,l.height_cm,_]),f.useEffect(()=>{var i,h,d,oo,ao,lo,mo;if(!l.housenumber)return;const a=(t||[]).find(r=>String(r.household_id)===String(l.household_id)&&(r.is_household_head===1||r.is_household_head===!0));if(!a)return;const m=[a.firstname,a.middlename,a.lastname,a.suffix].filter(Boolean).join(" "),c={household_id:a.household.household_id??a.household_id,street_id:a.household.street_id,street_name:((h=(i=a.household)==null?void 0:i.street)==null?void 0:h.street_name)||"",purok_id:((oo=(d=a.household)==null?void 0:d.purok)==null?void 0:oo.id)||((ao=a.household)==null?void 0:ao.purok_id)||"",purok_number:((mo=(lo=a.household)==null?void 0:lo.purok)==null?void 0:mo.purok_number)||"",name_of_head:m};_(r=>({...r,...c}))},[l.housenumber,t,_]);const ho=a=>{a.preventDefault(),_o(route("resident.update",o.id),{onError:m=>{console.log(m)}})};return u.jsx("div",{children:u.jsxs("form",{onSubmit:ho,children:[u.jsx(no,{data:l,setData:_,handleArrayValues:w,errors:n,showMaidenMiddleName:io,barangays:y,puroks:v,existingImagePath:co}),u.jsx(ro,{data:l,setData:_,errors:n,handleArrayValues:w}),u.jsx(yo,{data:l,setData:_,errors:n,occupationTypes:x}),u.jsx(vo,{data:l,setData:_,errors:n}),u.jsx(xo,{data:l,setData:_,handleArrayValues:w,errors:n,puroks:v,streets:s,households:t}),u.jsx("section",{className:"space-y-4 border border-gray-200 p-4 rounded-md my-4",children:u.jsxs("label",{className:"flex items-start space-x-2",children:[u.jsx(so,{name:"verified",value:l.verified,checked:l.verified===1||l.verified===!0,onChange:a=>_("verified",a.target.checked?1:0)}),u.jsx("span",{className:"text-sm text-gray-700",children:"I hereby certify that the above information is true and correct to the best of my knowledge. I understand that for the Barangay to carry out its mandate pursuant to Section 394(d)(6) of the Local Government Code of 1991, it must necessarily process my personal information for easy identification of inhabitants, as a tool in planning, and as an updated reference for the number of inhabitants in the Barangay. Therefore, I grant my consent and recognize the authority of the Barangay to process my personal information, subject to the provisions of the Philippine Data Privacy Act of 2012."})]})}),u.jsx("div",{className:"flex w-full justify-center items-center mt-7",children:u.jsx(bo,{className:"w-40",type:"submit",disabled:l.verified===0,children:"Submit"})})]})})};function ba({auth:v,puroks:x,occupationTypes:s,streets:t,households:y,barangays:o,resident:g=null}){const b=[{label:"Residents Information",showOnMobile:!1},{label:"Residents Table",href:route("resident.index"),showOnMobile:!1},{label:"Edit Resident",showOnMobile:!0}],p=po().props,l=(p==null?void 0:p.success)??null,_=(p==null?void 0:p.error)??null;return f.useEffect(()=>{l&&uo.success(l,{description:"Operation successful!",duration:3e3,closeButton:!0}),p.success=null},[l]),f.useEffect(()=>{_&&uo.error(_,{description:"Operation failed!",duration:3e3,closeButton:!0}),p.error=null},[_]),u.jsxs(So,{children:[u.jsx(fo,{title:"Resident Dashboard"}),u.jsx(wo,{richColors:!0}),u.jsx(go,{breadcrumbs:b}),u.jsx("div",{children:u.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:u.jsx("div",{className:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 my-8",children:u.jsxs("div",{className:" my-2 p-5",children:[_&&u.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:_}),u.jsx(jo,{puroks:x,occupationTypes:s,streets:t,households:y,barangays:o,resident:g.data})]})})})})]})}export{ba as default};
