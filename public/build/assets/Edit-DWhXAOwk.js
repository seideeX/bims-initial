import{K as T,m as A,r as C,j as e,L as D}from"./app-CDPwVV6Y.js";import M from"./BreadcrumbsHeader-BOSIhs5m.js";import{I as m}from"./InputError-CsvCol3W.js";import{I as j}from"./InputField-D_ZI8EKx.js";import{I as p}from"./InputLabel-C3y8TkvV.js";import{B as R}from"./button-B_aprJyo.js";import{S as O}from"./AdminLayout-BW3ywimG.js";import{S as P}from"./SelectField-DIeNwIQe.js";import{T as u}from"./textarea-CVDV7Abf.js";import{P as f}from"./ParticipantSection-By2um38y.js";import{t as y,T as $}from"./index-CH7DWExs.js";import{c as b}from"./createLucideIcon-B4SoG9zf.js";import{R as F}from"./rotate-ccw-D-jj88si.js";import{S as H}from"./save-knM2sn1D.js";import"./breadcrumb-DsnADmME.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-DYtVQaAj.js";import"./sidebar-BqlEtGlg.js";import"./input-DTbtaxsV.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./useAppUrl-BIsbUUVL.js";import"./DeleteConfirmationModal-DcMwm5QA.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./index-D4O4cOmu.js";import"./iconBase-DNpEM3Pe.js";import"./DropdownInputField-BmM-TOT_.js";import"./constants-DHCt9dPc.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],U=b("pen-line",K);function Ie({residents:E,blotter_details:a}){const S=[{label:"Katarungang Pambarangay",showOnMobile:!1},{label:"Blotter Reports",href:route("blotter_report.index"),showOnMobile:!1},{label:"Edit Blotter Report",showOnMobile:!0}],t=T().props,x=(t==null?void 0:t.success)??null,c=(t==null?void 0:t.error)??null,h=(s,g)=>(s==null?void 0:s.filter(n=>n.role_type===g).map(n=>{var d,l,N,w,k;return{resident_id:n.resident_id||"",resident_name:n.name||n.display_name||"",birthdate:((d=n.resident)==null?void 0:d.birthdate)||"",sex:((l=n.resident)==null?void 0:l.sex)||"",purok_number:((N=n.resident)==null?void 0:N.purok_number)||"",email:((w=n.resident)==null?void 0:w.email)||"",contact_number:((k=n.resident)==null?void 0:k.contact_number)||"",notes:n.notes||""}}))||[{resident_id:""}],{data:r,setData:o,post:I,errors:i,reset:L}=A({type_of_incident:(a==null?void 0:a.type_of_incident)??"",narrative_details:(a==null?void 0:a.narrative_details)??"",actions_taken:(a==null?void 0:a.actions_taken)??"",report_status:(a==null?void 0:a.report_status)??"",location:(a==null?void 0:a.location)??"",resolution:(a==null?void 0:a.resolution)??"",recommendations:(a==null?void 0:a.recommendations)??"",incident_date:(a==null?void 0:a.incident_date)??"",recorded_by:(a==null?void 0:a.recorded_by)??null,complainants:h(a==null?void 0:a.participants,"complainant"),respondents:h(a==null?void 0:a.participants,"respondent"),witnesses:h(a==null?void 0:a.participants,"witness"),blotter_id:a.id,_method:"PUT"}),B=s=>{s.preventDefault(),I(route("blotter_report.update",r.blotter_id),{onError:g=>{const n=Object.values(g).map((d,l)=>`<div key=${l}> ${d}</div>`);y.error("Validation Error",{description:e.jsx("div",{dangerouslySetInnerHTML:{__html:n.join("")}}),duration:4e3,closeButton:!0})}})},v=E.map(s=>({value:s.id,label:`${s.firstname} ${s.middlename?s.middlename+" ":""}${s.lastname}${s.suffix?", "+s.suffix:""}`,...s}));return C.useEffect(()=>{x&&(handleModalClose(),y.success(x,{description:"Operation successful!",duration:3e3,closeButton:!0})),t.success=null},[x]),C.useEffect(()=>{c&&y.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),t.error=null},[c]),e.jsxs(O,{children:[e.jsx($,{richColors:!0}),e.jsx(D,{title:"Edit Blotter Report"}),e.jsx(M,{breadcrumbs:S}),e.jsx("div",{children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:e.jsx("div",{className:"overflow-hidden bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 my-2",children:e.jsxs("div",{className:" my-2 p-2",children:[c&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:c}),e.jsx("div",{children:e.jsxs("form",{onSubmit:B,children:[e.jsxs("div",{className:"flex items-start gap-3 p-4 mb-6 bg-gray-50 rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(U,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg md:text-2xl font-semibold text-gray-800 mb-1",children:"Edit Blotter Report Form"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fill out the details of the incident, including participants, actions, and recommendations. Ensure all required fields are completed before submitting."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(j,{label:"Type of Incident",name:"type_of_incident",value:r.type_of_incident,onChange:s=>o("type_of_incident",s.target.value),placeholder:"Ex: Theft, Violence"}),e.jsx(m,{message:i.type_of_incident,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(j,{type:"datetime-local",label:"Incident Date & Time",name:"incident_date",value:r.incident_date,onChange:s=>o("incident_date",s.target.value)}),e.jsx(m,{message:i.incident_date,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(j,{label:"Location",name:"location",value:r.location,onChange:s=>o("location",s.target.value),placeholder:"Incident Location"}),e.jsx(m,{message:i.location,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(P,{label:"Report Status",name:"report_status",value:r.report_status||"",onChange:s=>o("report_status",s.target.value),items:[{label:"Pending",value:"pending"},{label:"On Going",value:"on_going"},{label:"Resolved",value:"resolved"},{label:"Elevated",value:"elevated"}],placeholder:"Select Status"}),e.jsx(m,{message:i.report_status,className:"mt-1"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(p,{value:"Narrative Details"}),e.jsx(u,{name:"narrative_details",value:r.narrative_details,onChange:s=>o("narrative_details",s.target.value),placeholder:"Describe what happened...",rows:4}),e.jsx(m,{message:i.narrative_details,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(p,{value:"Actions Taken"}),e.jsx(u,{name:"actions_taken",value:r.actions_taken,onChange:s=>o("actions_taken",s.target.value),placeholder:"What actions were taken?",rows:4}),e.jsx(m,{message:i.actions_taken,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(p,{value:"Resolution"}),e.jsx(u,{name:"resolution",value:r.resolution,onChange:s=>o("resolution",s.target.value),placeholder:"Resolution or settlement details...",rows:4}),e.jsx(m,{message:i.resolution,className:"mt-1"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx(p,{value:"Recommendations"}),e.jsx(u,{name:"recommendations",value:r.recommendations,onChange:s=>o("recommendations",s.target.value),placeholder:"Any recommendations for next steps...",rows:4}),e.jsx(m,{message:i.recommendations,className:"mt-1"})]})]}),e.jsx(f,{title:"Complainants",dataArray:r.complainants,setDataArray:s=>o("complainants",s),errors:i,residentsList:v}),e.jsx(f,{title:"Respondents",dataArray:r.respondents,setDataArray:s=>o("respondents",s),errors:i,residentsList:v}),e.jsx(f,{title:"Witnesses",dataArray:r.witnesses,setDataArray:s=>o("witnesses",s),errors:i,residentsList:v}),e.jsxs("div",{className:"flex w-full justify-end items-center mt-7 gap-4",children:[e.jsxs(R,{type:"button",onClick:()=>L(),variant:"outline",className:"text-gray-600 border-gray-300 hover:bg-gray-50 transition duration-150",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Reset Form"]}),e.jsxs(R,{type:"submit",className:"w-40 bg-green-600 hover:bg-green-700 transition duration-150 shadow-md",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Update Report"]})]})]})})]})})})})]})}export{Ie as default};
