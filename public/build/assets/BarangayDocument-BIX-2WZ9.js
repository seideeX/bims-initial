import{K as V,r as a,m as z,S as D,j as e,L as $}from"./app-CDPwVV6Y.js";import{S as J}from"./AdminLayout-BW3ywimG.js";import{B as x}from"./button-B_aprJyo.js";import{I as Q}from"./input-DTbtaxsV.js";import X from"./BreadcrumbsHeader-BOSIhs5m.js";import{I as G}from"./InputField-D_ZI8EKx.js";import{u as W}from"./useAppUrl-BIsbUUVL.js";import Y from"./DynamicTable-C_SQJSlc.js";import Z from"./ActionMenu-CazUS606.js";import q from"./SidebarModal-CSWrtQJc.js";import{T as ee}from"./textarea-CVDV7Abf.js";import{t as c,T as te}from"./index-CH7DWExs.js";import se from"./DeleteConfirmationModal-DcMwm5QA.js";import{S as ae}from"./SelectField-DIeNwIQe.js";import{S as le}from"./constants-DHCt9dPc.js";import{S as re}from"./search-BLeXCASV.js";import{L as oe}from"./list-plus-D4__nvo2.js";import{c as S}from"./createLucideIcon-B4SoG9zf.js";import{T as ie}from"./trash-2-DGe7ZjJ3.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./chevron-right-DYtVQaAj.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./breadcrumb-DsnADmME.js";import"./ellipsis-pjh7Fz_j.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],ce=S("file-check-2",ne);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]],me=S("file-plus-2",de);function qe({documents:k,queryParams:r}){const C=[{label:"Residents Information",showOnMobile:!1},{label:"Documents",showOnMobile:!0}];r=r||{},W();const l=V().props,f=(l==null?void 0:l.success)??null,d=(l==null?void 0:l.error)??null,[F,m]=a.useState(!1),[u,b]=a.useState(null),[g,T]=a.useState(r.name??""),p=a.useRef(null),M=t=>{t.preventDefault(),j("name",g)},j=(t,s)=>{s&&s.trim()!==""?r[t]=s:delete r[t],r.page&&delete r.page,D.get(route("document.index",r))},_=(t,s)=>{if(s.key==="Enter")j(t,s.target.value);else return},I=()=>{p.current.click()},v=[{key:"id",label:"ID"},{key:"name",label:"Document Name"},{key:"specific_purpose",label:"Specific Purpose"},{key:"created_at",label:"Date Added"},{key:"actions",label:"Actions"}],[A,y]=a.useState(!1),[ue,pe]=a.useState(null),[E,xe]=a.useState(!0),[N,O]=a.useState(!1),L={id:t=>t.id,name:t=>t.name,specific_purpose:t=>le[t.specific_purpose],created_at:t=>new Date(t.created_at).toLocaleDateString(),actions:t=>e.jsx(Z,{actions:[{label:"Delete",icon:e.jsx(ie,{className:"w-4 h-4 text-red-600"}),onClick:()=>H(t.id)}]})},R=()=>{y(!0)},h=()=>{y(!1),P()},{data:i,setData:n,post:B,errors:o,processing:w,reset:P}=z({name:"",description:"",file:null}),U=t=>{t.preventDefault(),B(route("document.store"),{onError:s=>{console.error("Validation Errors:",s),c.error("Action Failed",{description:s?JSON.stringify(s):"Unable to add document.",duration:4e3,closeButton:!0})}})},H=t=>{b(t),m(!0)},K=a.useMemo(()=>()=>{u&&D.delete(route("document.destroy",u),{onSuccess:()=>{c.success("Document deleted successfully!"),m(!1),b(null)},onError:t=>{c.error("Failed to delete resident.",{description:t.message}),m(!1)}})},[u]);return a.useEffect(()=>{f&&(h(),c.success(f,{description:"Operation successful!",duration:3e3,closeButton:!0})),l.success=null},[f]),a.useEffect(()=>{d&&(c.error("Action Failed",{description:typeof d=="string"?d:"An unexpected error occurred.",duration:3e3,closeButton:!0}),l.setError&&l.setError(null))},[d]),e.jsxs(J,{children:[e.jsx($,{title:"Documents Dashboard"}),e.jsxs("div",{children:[e.jsx(te,{richColors:!0}),e.jsx(X,{breadcrumbs:C}),e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsx("div",{className:"overflow-hidden bg-gray-50 shadow-sm rounded-xl sm:rounded-lg p-4 my-8 ",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 w-full mb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"List of Documents"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage, search, and upload documents within the system."})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsxs("form",{onSubmit:M,className:"flex w-[280px] max-w-lg items-center space-x-1",children:[e.jsx(Q,{type:"text",placeholder:"Search by name",value:g,onChange:t=>T(t.target.value),onKeyDown:t=>_("name",t),className:"w-full"}),e.jsxs("div",{className:"relative group",children:[e.jsx(x,{type:"submit",className:"border border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white active:bg-blue-900 flex items-center gap-2 bg-transparent",variant:"outline",children:e.jsx(re,{})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(x,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",onClick:R,children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Add a Document"})]})]})]}),e.jsx(Y,{passedData:k,columnRenderers:L,allColumns:v,is_paginated:E,toggleShowAll:()=>O(!N),showAll:N,visibleColumns:v.map(t=>t.key)})]})})}),e.jsx(q,{isOpen:A,onClose:h,title:"Add Document",children:e.jsx("div",{className:"w-full p-4 bg-gray-50 rounded-md",children:e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Document Details"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Fill out the form below to upload a new document."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"file",className:"text-sm font-medium text-gray-700",children:"Upload File"}),e.jsx("input",{id:"file",type:"file",ref:p,onChange:t=>{var s;return n("file",((s=t.target.files)==null?void 0:s[0])||null)},className:"hidden"}),e.jsx("div",{onClick:I,onDragOver:t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.classList.add("border-blue-400","bg-blue-50")},onDragLeave:t=>{t.preventDefault(),t.stopPropagation(),t.currentTarget.classList.remove("border-blue-400","bg-blue-50")},onDrop:t=>{if(t.preventDefault(),t.stopPropagation(),t.currentTarget.classList.remove("border-blue-400","bg-blue-50"),t.dataTransfer.files&&t.dataTransfer.files.length>0){const s=t.dataTransfer.files[0];n("file",s),p.current&&(p.current.files=t.dataTransfer.files),t.dataTransfer.clearData()}},className:`flex flex-col items-center justify-center w-full h-40 border-2 border-dashed rounded-lg cursor-pointer transition ${i.file?"border-blue-400 bg-blue-50":"border-gray-300 bg-gray-50 hover:border-blue-400 hover:bg-blue-50"}`,children:i.file?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-10 w-10 text-blue-500"}),e.jsx("p",{className:"mt-2 text-sm text-gray-700",children:i.file.name})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-10 w-10 text-blue-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Click or drag & drop to upload"})]})}),o.file&&e.jsx("p",{className:"text-xs text-red-600",children:o.file})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2 w-full",children:[e.jsx("label",{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Document Name"}),e.jsx(G,{id:"name",type:"text",name:"name",value:i.name,onChange:t=>n("name",t.target.value),placeholder:"e.g., Barangay Clearance",className:"w-full"}),o.name&&e.jsx("p",{className:"text-xs text-red-600",children:o.name})]}),e.jsxs("div",{className:"space-y-2 w-full",children:[e.jsx("label",{htmlFor:"name",className:"text-sm font-medium text-gray-700",children:"Specific Purpose"}),e.jsx(ae,{name:"specific_purpose",value:i.specific_purpose||"",onChange:t=>n("specific_purpose",t.target.value),items:[{label:"Certification",value:"certification"},{label:"Blotter Report Form",value:"blotter"},{label:"Summon Report Form",value:"summon"},{label:"File to Action Form",value:"file_action"}]}),o.name&&e.jsx("p",{className:"text-xs text-red-600",children:o.name})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700",children:"Description"}),e.jsx(ee,{id:"description",name:"description",value:i.description,onChange:t=>n("description",t.target.value),placeholder:"Brief description of the document",rows:4,className:"w-full text-gray-600"}),o.description&&e.jsx("p",{className:"text-xs text-red-600",children:o.description})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-6 border-t",children:[e.jsx(x,{type:"button",variant:"outline",onClick:h,className:"px-4 py-2 rounded-lg text-gray-500 hover:text-black",children:"Cancel"}),e.jsx(x,{type:"submit",disabled:w,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Submitting...":"Submit"})]})]})})}),e.jsx(se,{isOpen:F,onClose:()=>m(!1),onConfirm:K,residentId:u})]})]})}export{qe as default};
