import{K as Q,r as i,j as t,L as J,$ as Z,S as x,a as q}from"./app-CDPwVV6Y.js";import ee from"./BreadcrumbsHeader-BOSIhs5m.js";import{S as te,H as se}from"./AdminLayout-BW3ywimG.js";import oe from"./ActionMenu-CazUS606.js";import ie from"./DynamicTable-C_SQJSlc.js";import{B as D}from"./button-B_aprJyo.js";import{I as ae}from"./input-DTbtaxsV.js";import{M as R,m as le,H as ne,n as re,o as de,p as ce,R as me,b as ue}from"./constants-DHCt9dPc.js";import pe from"./DynamicTableControls-CcWMFg7f.js";import he from"./FillterToggle-cYp57TD0.js";import xe from"./PersonDetailContent-ghJKAROu.js";import fe from"./SidebarModal-CSWrtQJc.js";import"./react-datepicker-BTgyaUwu.js";import{u as ge}from"./useAppUrl-BIsbUUVL.js";import ye from"./DeleteConfirmationModal-DcMwm5QA.js";import{t as I,T as we}from"./index-CH7DWExs.js";import{S as _e}from"./search-BLeXCASV.js";import{N as be}from"./network-Uu4RV5M0.js";import{E as Ne}from"./eye-CTOC_KFU.js";import{S as je}from"./square-pen-7JDEATcf.js";import{X as Ee}from"./x-rg4AgZHH.js";import"./breadcrumb-DsnADmME.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./chevron-right-DYtVQaAj.js";import"./createLucideIcon-B4SoG9zf.js";import"./sidebar-BqlEtGlg.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./ellipsis-pjh7Fz_j.js";import"./index-BntGPR1O.js";import"./iconBase-DNpEM3Pe.js";import"./index-BDJITxkD.js";import"./index-BvB2ajn5.js";function gt({members:r,family_details:f,household_details:Se,queryParams:a=null}){const O=[{label:"Residents Information",showOnMobile:!1},{label:"Families",href:route("family.index"),showOnMobile:!1},{label:"View Family",showOnMobile:!0}],k=ge();a=a||{};const l=Q().props,d=(l==null?void 0:l.success)??null,c=(l==null?void 0:l.error)??null,[g,C]=i.useState(a.name??""),[y,A]=i.useState(null),M=e=>{e.preventDefault(),m("name",g)},m=(e,s)=>{s&&s.trim()!==""?a[e]=s:delete a[e],a.page&&delete a.page,x.get(route("family.showfamily",{family:f.id,...a}))},F=(e,s)=>{if(s.key==="Enter")m(e,s.target.value);else return},u=[{key:"resident_id",label:"Resident ID"},{key:"name",label:"Resident Name"},{key:"gender",label:"Gender"},{key:"age",label:"Age"},{key:"relationship_to_head",label:"Relationship to Head"},{key:"household_position",label:"Household Position"},{key:"employment_status",label:"Employment Status"},{key:"registered_voter",label:"Register Voter"},{key:"is_pwd",label:"Is PWD"},{key:"actions",label:"Actions"}],H=e=>{x.get(route("resident.edit",e))},[L,p]=i.useState(!1),[w,U]=i.useState(null),V=e=>{U(e),p(!0)},$=()=>{x.get(route("family.remove",w)),p(!1)},P=e=>{if(!e)return"Unknown";const s=new Date(e),o=new Date;let n=o.getFullYear()-s.getFullYear();const T=o.getMonth()-s.getMonth();return(T<0||T===0&&o.getDate()<s.getDate())&&n--,n},[X,_]=i.useState(!1),[b,z]=i.useState(null),B=async e=>{try{const s=await q.get(`${k}/resident/showresident/${e}`);z(s.data.resident)}catch(s){console.error("Error fetching placeholders:",s)}_(!0)},[N,j]=i.useState(u.map(e=>e.key)),[G,ve]=i.useState(!0),[E,K]=i.useState(!1),h=Object.entries(a||{}).some(([e,s])=>["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"].includes(e)&&s&&s!=="All");i.useEffect(()=>{h&&v(!0)},[h]);const[S,v]=i.useState(h),Y=()=>{window.print()};i.useEffect(()=>{if(!Array.isArray(r))return;const e=r.find(s=>{var o;return(o=s.household_residents)==null?void 0:o.some(n=>n.relationship_to_head==="self")});A((e==null?void 0:e.id)??null)},[r]);const W={resident_id:e=>e.id,name:e=>`${e.firstname} ${e.middlename??""} ${e.lastname??""} ${e.suffix??""}`,gender:e=>{const s=e.gender,o=me[s]??"Unknown",n=ue[s]??"bg-gray-300";return t.jsx("span",{className:`py-1 px-2 rounded-xl text-sm font-medium ${n}`,children:o})},age:e=>{const s=P(e.birthdate);return typeof s!="number"?"Unknown":t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("span",{className:"font-medium text-gray-800",children:[s," years old"]}),s>60&&t.jsx("span",{className:"text-xs text-rose-600 font-semibold",children:"Senior Citizen"})]})},relationship_to_head:e=>{var s,o;return re[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.relationship_to_head]||t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"})},household_position:e=>{var s,o;return ne[(o=(s=e.household_residents)==null?void 0:s[0])==null?void 0:o.household_position]||t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"})},employment_status:e=>le[e==null?void 0:e.employment_status],registered_voter:e=>{const s=(e==null?void 0:e.registered_voter)??0,o=de[s]??"Unknown",n=ce[s]??"p-1 bg-gray-300 text-black rounded-lg";return t.jsx("span",{className:n,children:o})},is_pwd:e=>(e==null?void 0:e.is_pwd)in R?R[e.is_pwd]:t.jsx("span",{className:"text-gray-400 italic",children:"Not specified"}),actions:e=>t.jsx(oe,{actions:[{label:"View",icon:t.jsx(Ne,{className:"w-4 h-4 text-indigo-600"}),onClick:()=>B(e.id)},{label:"Edit",icon:t.jsx(je,{className:"w-4 h-4 text-green-500"}),onClick:()=>H(e.id)},{label:"Remove",icon:t.jsx(Ee,{className:"w-4 h-4 text-red-600"}),onClick:()=>V(e.id)}]})};return i.useEffect(()=>{d&&I.success(d,{description:"Operation successful!",duration:3e3,closeButton:!0}),l.success=null},[d]),i.useEffect(()=>{c&&I.error(c,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[c]),t.jsxs(te,{children:[t.jsx(J,{title:"Family"}),t.jsx(ee,{breadcrumbs:O}),t.jsx(we,{richColors:!0}),t.jsx("div",{className:"pt-4",children:t.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:t.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[t.jsx("div",{className:"mb-6",children:t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:t.jsx(se,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Family Details"}),t.jsx("p",{className:"text-sm text-gray-500",children:"View and manage the records of this specific family, including members, relationships, and household links."})]})]})}),t.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-2 w-full mb-0",children:[t.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:t.jsx(pe,{allColumns:u,visibleColumns:N,setVisibleColumns:j,onPrint:Y,showFilters:S,toggleShowFilters:()=>v(e=>!e)})}),t.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[t.jsxs("form",{onSubmit:M,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[t.jsx(ae,{type:"text",placeholder:"Search for Household Member Name",value:g,onChange:e=>C(e.target.value),onKeyDown:e=>F("name",e),className:"w-full"}),t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{type:"submit",className:"border active:bg-blue-900 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white flex items-center gap-2 bg-transparent",variant:"outline",children:t.jsx(_e,{})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Search"})]})]}),y&&t.jsx(Z,{href:route("resident.familytree",{resident:y}),children:t.jsxs("div",{className:"relative group z-50",children:[t.jsx(D,{variant:"outline",className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:t.jsx(be,{className:"w-4 h-4"})}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 rounded-md bg-blue-700 text-white text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:"Family Tree"})]})})]})]}),S&&t.jsx(he,{queryParams:a,searchFieldName:m,visibleFilters:["gender","age_group","relation","household_position","estatus","voter_status","is_pwd"],showFilters:!0,clearRouteName:"family.showfamily",clearRouteParams:{family:f.id}}),t.jsx(ie,{passedData:r,columnRenderers:W,allColumns:u,is_paginated:G,toggleShowAll:()=>K(!E),showAll:E,visibleColumns:N,setVisibleColumns:j})]})})}),t.jsx(fe,{isOpen:X,onClose:()=>_(!1),title:"Resident Details",children:b&&t.jsx(xe,{person:b})}),t.jsx(ye,{isOpen:L,onClose:()=>{p(!1)},onConfirm:$,residentId:w,title:"Confirm Removal",message:"Are you sure you want to remove resident from this household? This action cannot be undone.",buttonLabel:"I UNDERSTAND, REMOVE"})]})}export{gt as default};
