import{K as te,r as o,m as se,j as e,L as ae,S as B,a as oe}from"./app-CDPwVV6Y.js";import{u as re}from"./useAppUrl-BIsbUUVL.js";import{S as ne}from"./AdminLayout-BW3ywimG.js";import le from"./ActionMenu-CazUS606.js";import{I as ie}from"./InputField-D_ZI8EKx.js";import{B as m}from"./button-B_aprJyo.js";import{I as de}from"./input-DTbtaxsV.js";import ce from"./SidebarModal-CSWrtQJc.js";import{I as me,a as ue,b as pe}from"./index-D4O4cOmu.js";import{D as xe}from"./DropdownInputField-BmM-TOT_.js";import{t as i,T as fe}from"./index-CH7DWExs.js";import he from"./DeleteConfirmationModal-DcMwm5QA.js";import be from"./BreadcrumbsHeader-BOSIhs5m.js";import"./react-datepicker-BTgyaUwu.js";import"./dropdown-menu-DFrz86N0.js";import ge from"./DynamicTable-C_SQJSlc.js";import{I as D}from"./InputError-CsvCol3W.js";import{M as je}from"./map-pin-DjiyU5Lq.js";import{S as ye}from"./search-BLeXCASV.js";import{L as ve}from"./list-plus-D4__nvo2.js";import{R as Ne}from"./rotate-ccw-D-jj88si.js";import{S as Le}from"./square-pen-7JDEATcf.js";import{T as Se}from"./trash-2-DGe7ZjJ3.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./createLucideIcon-B4SoG9zf.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./ellipsis-pjh7Fz_j.js";import"./check-BsJSkZwI.js";import"./chevron-right-DYtVQaAj.js";import"./iconBase-DNpEM3Pe.js";import"./breadcrumb-DsnADmME.js";import"./index-BntGPR1O.js";function bt({bodiesOfLand:M,queryParams:r}){const _=[{label:"Barangay Resources",showOnMobile:!1},{label:"Bodies of Land",showOnMobile:!0}],A=re();r=r||{};const n=te().props,u=(n==null?void 0:n.success)??null,p=(n==null?void 0:n.error)??null,[k,x]=o.useState(!1),[T,f]=o.useState(""),[d,y]=o.useState(null),[v,V]=o.useState(r.name??""),[F,h]=o.useState(!1),[N,R]=o.useState(null),L=[{key:"id",label:"ID"},{key:"name",label:"Name"},{key:"type",label:"Type"},{key:"exists",label:"Exists"},{key:"created_at",label:"Created At"},{key:"actions",label:"Actions"}],H=L.map(t=>t.key),[b,we]=o.useState(()=>{const t=localStorage.getItem("land_visible_columns");return t?JSON.parse(t):H}),U=["Mountain ranges","Mountain","Volcano","Cliff","Archipelago","Island","Plains","Valley"];o.useEffect(()=>{localStorage.setItem("land_visible_columns",JSON.stringify(b))},[b]);const g=Object.entries(r||{}).some(([t,s])=>[].includes(t)&&s&&s!=="");o.useEffect(()=>{g&&$(!0)},[g]);const[Oe,$]=o.useState(g),K=t=>{t.preventDefault(),S("name",v)},S=(t,s)=>{s&&s.trim()!==""?r[t]=s:delete r[t],r.page&&delete r.page,B.get(route("land.index",r))},J=(t,s)=>{s.key==="Enter"&&S(t,s.target.value)},z={id:t=>t.id,name:t=>e.jsx("span",{className:"font-medium text-gray-900",children:t.name||"—"}),type:t=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium capitalize",children:t.type||"—"}),exists:t=>e.jsx("span",{className:`px-2 py-0.5 rounded-md text-xs font-medium ${t.exists?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.exists?"Yes":"No"}),created_at:t=>e.jsx("span",{className:"text-sm text-gray-500",children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}),actions:t=>e.jsx(le,{actions:[{label:"Edit",icon:e.jsx(Le,{className:"w-4 h-4 text-green-500"}),onClick:()=>X(t.id)},{label:"Delete",icon:e.jsx(Se,{className:"w-4 h-4 text-red-600"}),onClick:()=>q(t.id)}]})},P=()=>{f("add"),x(!0)},{data:l,setData:c,post:w,errors:O,reset:C,clearErrors:Q}=se({bodiesOfLand:[{}],_method:void 0,land_id:null}),E=(t,s,a)=>{const j=[...l.bodiesOfLand||[]];j[s]={...j[s],[a]:t},c("bodiesOfLand",j)},Y=()=>{c("bodiesOfLand",[...l.bodiesOfLand||[],{name:"",type:"",exists:!1}])},G=t=>{const s=[...l.bodiesOfLand||[]];s.splice(t,1),c("bodiesOfLand",s),i.warning("Body of Land removed.",{duration:2e3})},W=t=>{t.preventDefault(),w(route("land.store"),{onError:s=>{console.error("Validation Errors:",s);const a=Object.values(s).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:a}}),duration:3e3,closeButton:!0})}})},X=async t=>{f("edit");try{const a=(await oe.get(`${A}/land/details/${t}`)).data.land;y(a),c({bodiesOfLand:[{name:a.name||"",type:a.type||""}],_method:"PUT",land_id:a.id}),x(!0)}catch(s){console.error("Error fetching land details:",s)}},Z=t=>{t.preventDefault(),w(route("land.update",l.land_id),{onError:s=>{console.error("Validation Errors:",s);const a=Object.values(s).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:a}}),duration:3e3,closeButton:!0})}})},q=t=>{R(t),h(!0)},ee=()=>{B.delete(route("land.destroy",N),{onError:t=>{console.error("Validation Errors:",t);const s=Object.values(t).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:s}}),duration:3e3,closeButton:!0})}}),h(!1)},I=()=>{x(!1),f(""),y(null),C(),Q()};return o.useEffect(()=>{u&&(I(),i.success(u,{description:"Operation successful!",duration:3e3,closeButton:!0})),n.success=null},[u]),o.useEffect(()=>{p&&i.error(p,{description:"Operation failed!",duration:3e3,closeButton:!0}),n.error=null},[p]),e.jsxs(ne,{children:[e.jsx(ae,{title:"Barangay Infrastructure"}),e.jsx(be,{breadcrumbs:_}),e.jsx(fe,{richColors:!0}),e.jsxs("div",{className:"pt-4 mb-10",children:[e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"p-2 bg-green-100 rounded-full",children:[e.jsx(je,{className:"w-6 h-6 text-green-600"})," "]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Bodies of Land Overview"}),e.jsx("p",{className:"text-sm text-gray-500",children:"View, filter, and manage mountains, hills, plains, and other land formations within your barangay."})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"flex flex-wrap justify-end gap-2 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:K,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(de,{type:"text",placeholder:"Search name",value:v,onChange:t=>V(t.target.value),onKeyDown:t=>J("name",t),className:"ml-4"}),e.jsx(m,{type:"submit",className:"border border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",variant:"outline",children:e.jsx(ye,{})})]}),e.jsxs(m,{variant:"outline",onClick:P,className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:[e.jsx(ve,{className:"w-4 h-4"}),"Add Body of Land"]})]})}),e.jsx(ge,{queryParams:r,passedData:M,allColumns:L,columnRenderers:z,visibleColumns:b,showTotal:!0})]})]})}),e.jsx(ce,{isOpen:k,onClose:I,title:T==="add"?"Add Body of Land":"Edit Body of Land",children:e.jsxs("form",{className:"bg-gray-50 p-4 rounded-lg",onSubmit:d?Z:W,children:[e.jsx("h3",{className:"text-2xl font-medium text-gray-700",children:"Body of Land Information"}),e.jsx("p",{className:"text-sm text-gray-500 mb-8",children:"Provide accurate information about the body of land located within your barangay. This helps track natural resources and manage land planning."}),Array.isArray(l.bodiesOfLand)&&l.bodiesOfLand.map((t,s)=>e.jsxs("div",{className:"border p-4 mb-4 rounded-md relative bg-white shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(ie,{label:"Name of Body of Land",name:"name",value:t.name||"",onChange:a=>E(a.target.value,s,"name"),placeholder:"e.g., Mountain A, Hill B, Barangay Field"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the official or local name of the land formation."}),e.jsx(D,{message:O[`bodiesOfLand.${s}.name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(xe,{label:"Type of Land Body",name:"type",value:t.type||"",onChange:a=>E(a.target.value,s,"type"),items:U,placeholder:"Select or enter type (e.g., Mountain, Hill, Plain)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the classification that best describes this land formation."}),e.jsx(D,{message:O[`bodiesOfLand.${s}.type`],className:"mt-1"})]})]}),d===null&&e.jsx("button",{type:"button",onClick:()=>G(s),className:"absolute top-1 right-2 flex items-center gap-1 text-sm text-red-400 hover:text-red-800 font-medium mt-1 transition-colors duration-200",children:e.jsx(me,{className:"text-2xl"})})]},s)),e.jsxs("div",{className:"flex justify-between items-center p-3",children:[d===null?e.jsxs("button",{type:"button",onClick:Y,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800 font-medium mt-4 transition-colors duration-200",children:[e.jsx(ue,{className:"text-2xl"}),e.jsx("span",{children:"Add Another Body of Land"})]}):null,e.jsxs("div",{className:"flex justify-end items-center text-end mt-5 gap-4",children:[d==null&&e.jsxs(m,{type:"button",onClick:()=>C(),children:[e.jsx(Ne,{})," Reset"]}),e.jsxs(m,{className:"bg-green-700 hover:bg-green-400",type:"submit",children:[d?"Update":"Add"," ",e.jsx(pe,{})]})]})]})]})}),e.jsx(he,{isOpen:F,onClose:()=>{h(!1)},onConfirm:ee,residentId:N})]})]})}export{bt as default};
