import{r as u,j as a,L as N,S as j}from"./app-CDPwVV6Y.js";import{S as v}from"./AdminLayout-BW3ywimG.js";import k from"./BreadcrumbsHeader-BOSIhs5m.js";import{T as m}from"./TableSection-DJejfqZ4.js";import l from"./DynamicTable-C_SQJSlc.js";import{N as F}from"./NoDataPlaceholder-dm08Djn6.js";import{B as C}from"./BarangayFilterCard-BXzB8O3P.js";import{B as S}from"./button-B_aprJyo.js";import{T as c}from"./triangle-alert-DIUemMd0.js";import{F as B}from"./file-spreadsheet-DsqN-gKN.js";import{C as w}from"./chart-column-cTpMJaE-.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./input-DTbtaxsV.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./createLucideIcon-B4SoG9zf.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./dropdown-menu-DFrz86N0.js";import"./check-BsJSkZwI.js";import"./chevron-right-DYtVQaAj.js";import"./useAppUrl-BIsbUUVL.js";import"./index-CH7DWExs.js";import"./DeleteConfirmationModal-DcMwm5QA.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./breadcrumb-DsnADmME.js";import"./card-B7XZtP7B.js";import"./SelectField-DIeNwIQe.js";function ge({hazardRiskData:r=[],overallHazardRiskData:n=[],barangayTopHazards:s=[],barangays:b=[],selectedBarangay:g,queryParams:p={}}){const d=[{label:"Dashboard",showOnMobile:!0}],x=e=>{const t=e.target.value;j.get(route("cdrrmo_admin.hazardrisks"),t?{barangay_id:t}:{})},_=!(r!=null&&r.length)&&!(n!=null&&n.length),i=[{key:"id",label:"No."},{key:"hazard_name",label:"Hazard"},{key:"probability_no",label:"Probability"},{key:"effect_no",label:"Effect"},{key:"management_no",label:"Management"},{key:"average_score",label:"Average Score"},{key:"basis",label:"Basis"}],[y]=u.useState(i.map(e=>e.key)),f={id:e=>a.jsx("span",{className:"text-xs font-semibold text-gray-500",children:e.id}),barangay_name:e=>a.jsx("span",{className:"font-medium text-gray-800",children:e.barangay_name}),hazard_name:e=>a.jsx("span",{className:"font-semibold text-red-700",children:e.hazard_name}),probability_no:e=>a.jsx("span",{className:"text-gray-700",children:e.probability_no??"—"}),effect_no:e=>a.jsx("span",{className:"text-gray-700",children:e.effect_no??"—"}),management_no:e=>a.jsx("span",{className:"text-gray-700",children:e.management_no??"—"}),average_score:e=>a.jsx("span",{className:`font-semibold ${e.average_score>=4?"text-red-600":e.average_score>=3?"text-orange-500":"text-green-600"}`,children:Number(e.average_score).toFixed(2)}),basis:e=>a.jsx("span",{className:"text-sm text-gray-600",children:e.basis||"—"})},h=()=>{const e=sessionStorage.getItem("cra_year")||selectedYear||new Date().getFullYear(),o=`${window.location.origin}/cdrrmo_admin/cra/top-hazard/pdf?year=${e}`;window.open(o,"_blank")};return a.jsxs(v,{children:[a.jsx(N,{title:"Hazard Risk Assessment"}),a.jsx(k,{breadcrumbs:d}),a.jsx("div",{className:"pt-8 pb-2 min-h-screen bg-gray-50",children:a.jsx("div",{className:"mx-auto w-full",children:_?a.jsx("div",{className:"w-full px-2 sm:px-4 lg:px-6",children:a.jsx(F,{tip:"Select a year and barangay to view Hazard Risk data."})}):a.jsxs(a.Fragment,{children:[a.jsx(C,{selectedBarangay:g,handleBarangayChange:x,barangays:b}),(r==null?void 0:r.length)>0&&a.jsx(m,{icon:a.jsx(c,{}),color:"red",title:"Barangay Hazard Risk Assessment",description:"Displays detailed risk scores for each hazard in the selected barangay, including probability, effect, management, and computed average.",tableProps:{component:l,passedData:r.flatMap(e=>e.hazards.map((t,o)=>({id:o+1,rank:t.rank,hazard_name:t.hazard_name,probability_no:t.probability_no,effect_no:t.effect_no,management_no:t.management_no,average_score:t.average_score,basis:t.basis}))),allColumns:i,columnRenderers:f,queryParams:p,visibleColumns:y,tableHeight:"500px"}}),(n==null?void 0:n.length)>0&&a.jsx(m,{icon:a.jsx(w,{}),color:"blue",title:"Overall Hazard Risk Summary",description:"Shows the aggregated average scores per hazard across all barangays for the selected year, including probability, effect, management, and ranking.",tableProps:{component:l,passedData:n,allColumns:[{key:"number",label:"No."},{key:"hazard_name",label:"Hazard"},{key:"avg_probability",label:"Probability"},{key:"avg_effect",label:"Effect"},{key:"avg_management",label:"Management"},{key:"avg_score",label:"Average"},{key:"rank",label:"Rank"}],columnRenderers:{number:e=>a.jsx("span",{className:"text-xs font-semibold text-gray-500",children:e.number}),hazard_name:e=>a.jsx("span",{className:"font-medium text-gray-800",children:e.hazard_name}),avg_probability:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.avg_probability).toFixed(2)}),avg_effect:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.avg_effect).toFixed(2)}),avg_management:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.avg_management).toFixed(2)}),avg_score:e=>a.jsx("span",{className:`font-semibold ${e.avg_score>=4?"text-red-600":e.avg_score>=3?"text-orange-500":"text-green-600"}`,children:Number(e.avg_score).toFixed(2)}),rank:e=>a.jsx("span",{className:"text-sm font-semibold text-blue-600",children:e.rank})},visibleColumns:["number","hazard_name","avg_probability","avg_effect","avg_management","avg_score","rank"],tableHeight:"450px"},children:a.jsxs(S,{onClick:h,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg shadow-sm transition duration-200",children:[a.jsx(B,{className:"w-5 h-5"}),"Export Data"]})}),(s==null?void 0:s.length)>0&&a.jsx(m,{icon:a.jsx(c,{}),color:"amber",title:"Top Hazard per Barangay",description:"Lists each barangay with its highest-rated hazard, including probability, effect, management, and computed average score.",tableProps:{component:l,passedData:s,allColumns:[{key:"number",label:"No."},{key:"barangay_name",label:"Barangay"},{key:"top_hazard",label:"Top Hazard"},{key:"probability_no",label:"Probability"},{key:"effect_no",label:"Effect"},{key:"management_no",label:"Management"},{key:"average_score",label:"Average Score"}],columnRenderers:{number:e=>a.jsx("span",{className:"text-xs font-semibold text-gray-500",children:e.number}),barangay_name:e=>a.jsx("span",{className:"font-medium text-gray-800",children:e.barangay_name}),top_hazard:e=>a.jsx("span",{className:"font-semibold text-red-700",children:e.top_hazard}),probability_no:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.probability_no).toFixed(2)}),effect_no:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.effect_no).toFixed(2)}),management_no:e=>a.jsx("span",{className:"text-gray-700",children:Number(e.management_no).toFixed(2)}),average_score:e=>a.jsx("span",{className:`font-semibold ${e.average_score>=4?"text-red-600":e.average_score>=3?"text-orange-500":"text-green-600"}`,children:Number(e.average_score).toFixed(2)})},visibleColumns:["number","barangay_name","top_hazard","probability_no","effect_no","management_no","average_score"],tableHeight:"500px"}})]})})})]})}export{ge as default};
