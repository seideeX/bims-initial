import{K as te,r as a,m as se,j as e,L as re,S as k,a as ae}from"./app-CDPwVV6Y.js";import{u as oe}from"./useAppUrl-BIsbUUVL.js";import{S as le,W as ne}from"./AdminLayout-BW3ywimG.js";import ie from"./ActionMenu-CazUS606.js";import{I as de}from"./InputField-D_ZI8EKx.js";import{B as m}from"./button-B_aprJyo.js";import{I as ce}from"./input-DTbtaxsV.js";import me from"./SidebarModal-CSWrtQJc.js";import{I as ue,a as pe,b as xe}from"./index-D4O4cOmu.js";import{D as fe}from"./DropdownInputField-BmM-TOT_.js";import{t as i,T as he}from"./index-CH7DWExs.js";import be from"./DeleteConfirmationModal-DcMwm5QA.js";import ge from"./BreadcrumbsHeader-BOSIhs5m.js";import"./react-datepicker-BTgyaUwu.js";import"./dropdown-menu-DFrz86N0.js";import je from"./DynamicTable-C_SQJSlc.js";import{I as B}from"./InputError-CsvCol3W.js";import{S as ye}from"./search-BLeXCASV.js";import{L as ve}from"./list-plus-D4__nvo2.js";import{R as we}from"./rotate-ccw-D-jj88si.js";import{S as Ne}from"./square-pen-7JDEATcf.js";import{T as Se}from"./trash-2-DGe7ZjJ3.js";import"./sidebar-BqlEtGlg.js";import"./utils-CkmPJWYF.js";import"./clsx-B-dksMZM.js";import"./index-8Tef56KC.js";import"./index-Dsz93ONd.js";import"./floating-ui.react-dom-VvtSZ_DO.js";import"./x-rg4AgZHH.js";import"./createLucideIcon-B4SoG9zf.js";import"./tooltip-10O7WS77.js";import"./nav-user-BTW7oy-u.js";import"./avatar-p9YAZDXV.js";import"./file-text-DhLfxzDZ.js";import"./users-round-BK2vts8v.js";import"./heart-pulse-BRIexC2Z.js";import"./chevron-up-BBBA9wsx.js";import"./ellipsis-pjh7Fz_j.js";import"./check-BsJSkZwI.js";import"./chevron-right-DYtVQaAj.js";import"./iconBase-DNpEM3Pe.js";import"./breadcrumb-DsnADmME.js";import"./index-BntGPR1O.js";function ht({bodiesOfWater:D,queryParams:o}){const _=[{label:"Barangay Resources",showOnMobile:!1},{label:"Bodies of Water",showOnMobile:!0}],A=oe();o=o||{};const l=te().props,u=(l==null?void 0:l.success)??null,p=(l==null?void 0:l.error)??null,[T,x]=a.useState(!1),[M,f]=a.useState(""),[d,y]=a.useState(null),[v,L]=a.useState(o.name??""),[R,h]=a.useState(!1),[w,F]=a.useState(null),N=[{key:"id",label:"ID"},{key:"name",label:"Name"},{key:"type",label:"Type"},{key:"exists",label:"Exists"},{key:"created_at",label:"Created At"},{key:"actions",label:"Actions"}],V=N.map(t=>t.key),[b,Oe]=a.useState(()=>{const t=localStorage.getItem("water_visible_columns");return t?JSON.parse(t):V});a.useEffect(()=>{localStorage.setItem("water_visible_columns",JSON.stringify(b))},[b]);const g=Object.entries(o||{}).some(([t,s])=>[].includes(t)&&s&&s!=="");a.useEffect(()=>{g&&U(!0)},[g]);const[We,U]=a.useState(g),$=t=>{t.preventDefault(),S("name",v)},S=(t,s)=>{s&&s.trim()!==""?o[t]=s:delete o[t],o.page&&delete o.page,k.get(route("water.index",o))},H=(t,s)=>{s.key==="Enter"&&S(t,s.target.value)},K={id:t=>t.id,name:t=>e.jsx("span",{className:"font-medium text-gray-900",children:t.name||"—"}),type:t=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium capitalize",children:t.type||"—"}),exists:t=>e.jsx("span",{className:`px-2 py-0.5 rounded-md text-xs font-medium ${t.exists?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.exists?"Yes":"No"}),created_at:t=>e.jsx("span",{className:"text-sm text-gray-500",children:t.created_at?new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"—"}),actions:t=>e.jsx(ie,{actions:[{label:"Edit",icon:e.jsx(Ne,{className:"w-4 h-4 text-green-500"}),onClick:()=>Z(t.id)},{label:"Delete",icon:e.jsx(Se,{className:"w-4 h-4 text-red-600"}),onClick:()=>q(t.id)}]})},J=["Sea","River","Gulf (Inlet)","Lake","Spring","Falls","Creek"],z=()=>{f("add"),x(!0)},{data:n,setData:c,post:O,errors:W,reset:C,clearErrors:G}=se({bodiesOfWater:[{}],_method:void 0,water_id:null}),E=(t,s,r)=>{const j=[...n.bodiesOfWater||[]];j[s]={...j[s],[r]:t},c("bodiesOfWater",j)},Q=()=>{c("bodiesOfWater",[...n.bodiesOfWater||[],{name:"",type:"",exists:!1}])},Y=t=>{const s=[...n.bodiesOfWater||[]];s.splice(t,1),c("bodiesOfWater",s),i.warning("Body of Water removed.",{duration:2e3})},X=t=>{t.preventDefault(),O(route("water.store"),{onError:s=>{console.error("Validation Errors:",s);const r=Object.values(s).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:r}}),duration:3e3,closeButton:!0})}})},Z=async t=>{f("edit");try{const r=(await ae.get(`${A}/water/details/${t}`)).data.water;console.log(r),y(r),c({bodiesOfWater:[{name:r.name||"",type:r.type||""}],_method:"PUT",water_id:r.id}),x(!0)}catch(s){console.error("Error fetching water details:",s)}},P=t=>{t.preventDefault(),O(route("water.update",n.water_id),{onError:s=>{console.error("Validation Errors:",s);const r=Object.values(s).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:r}}),duration:3e3,closeButton:!0})}})},q=t=>{F(t),h(!0)},ee=()=>{k.delete(route("water.destroy",w),{onError:t=>{console.error("Validation Errors:",t);const s=Object.values(t).join("<br />");i.error("Validation Error",{description:e.jsx("span",{dangerouslySetInnerHTML:{__html:s}}),duration:3e3,closeButton:!0})}}),h(!1)},I=()=>{x(!1),f(""),y(null),C(),G()};return a.useEffect(()=>{u&&(I(),i.success(u,{description:"Operation successful!",duration:3e3,closeButton:!0})),l.success=null},[u]),a.useEffect(()=>{p&&i.error(p,{description:"Operation failed!",duration:3e3,closeButton:!0}),l.error=null},[p]),e.jsxs(le,{children:[e.jsx(re,{title:"Barangay Infrastructure"}),e.jsx(ge,{breadcrumbs:_}),e.jsx(he,{richColors:!0}),e.jsxs("div",{className:"pt-4 mb-10",children:[e.jsx("div",{className:"mx-auto max-w-8xl px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"p-2 bg-blue-100 rounded-full",children:[e.jsx(ne,{className:"w-6 h-6 text-blue-600"})," "]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-semibold text-gray-900",children:"Bodies of Water Overview"}),e.jsx("p",{className:"text-sm text-gray-500",children:"View, filter, and manage rivers, lakes, seas, and other bodies of water within your barangay."})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 shadow-sm rounded-xl sm:rounded-lg p-4 m-0",children:[e.jsx("div",{className:"flex flex-wrap justify-end gap-2 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("form",{onSubmit:$,className:"flex w-[300px] max-w-lg items-center space-x-1",children:[e.jsx(ce,{type:"text",placeholder:"Search name",value:v,onChange:t=>L(t.target.value),onKeyDown:t=>H("name",t),className:"ml-4"}),e.jsx(m,{type:"submit",className:"border border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",variant:"outline",children:e.jsx(ye,{})})]}),e.jsxs(m,{variant:"outline",onClick:z,className:"flex items-center gap-2 border-blue-300 text-blue-700 hover:bg-blue-600 hover:text-white",children:[e.jsx(ve,{className:"w-4 h-4"}),"Add Body of Water"]})]})}),e.jsx(je,{queryParams:o,passedData:D,allColumns:N,columnRenderers:K,visibleColumns:b,showTotal:!0})]})]})}),e.jsx(me,{isOpen:T,onClose:I,title:M==="add"?"Add Body of Water":"Edit Body of Water",children:e.jsxs("form",{className:"bg-gray-50 p-4 rounded-lg",onSubmit:d?P:X,children:[e.jsx("h3",{className:"text-2xl font-medium text-gray-700",children:"Body of Water Information"}),e.jsx("p",{className:"text-sm text-gray-500 mb-8",children:"Provide accurate information about the body of water located within your barangay. This helps track natural resources and manage environmental planning."}),Array.isArray(n.bodiesOfWater)&&n.bodiesOfWater.map((t,s)=>e.jsxs("div",{className:"border p-4 mb-4 rounded-md relative bg-white shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx(de,{label:"Name of Body of Water",name:"name",value:t.name||"",onChange:r=>E(r.target.value,s,"name"),placeholder:"e.g., Laguna Lake, River A, Barangay Pond"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the official or local name of the body of water."}),e.jsx(B,{message:W[`bodiesOfWater.${s}.name`],className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(fe,{label:"Type of Water Body",name:"type",value:t.type||"",onChange:r=>E(r.target.value,s,"type"),items:J,placeholder:"Select or enter type (e.g., River, Lake, Creek)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choose the classification that best describes this water body."}),e.jsx(B,{message:W[`bodiesOfWater.${s}.type`],className:"mt-1"})]})]}),d===null&&e.jsx("button",{type:"button",onClick:()=>Y(s),className:"absolute top-1 right-2 flex items-center gap-1 text-sm text-red-400 hover:text-red-800 font-medium mt-1 transition-colors duration-200",children:e.jsx(ue,{className:"text-2xl"})})]},s)),e.jsxs("div",{className:"flex justify-between items-center p-3",children:[d===null?e.jsxs("button",{type:"button",onClick:Q,className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800 font-medium mt-4 transition-colors duration-200",children:[e.jsx(pe,{className:"text-2xl"}),e.jsx("span",{children:"Add Another Body of Water"})]}):null,e.jsxs("div",{className:"flex justify-end items-center text-end mt-5 gap-4",children:[d==null&&e.jsxs(m,{type:"button",onClick:()=>C(),children:[e.jsx(we,{})," Reset"]}),e.jsxs(m,{className:"bg-blue-700 hover:bg-blue-400",type:"submit",children:[d?"Update":"Add"," ",e.jsx(xe,{})]})]})]})]})}),e.jsx(be,{isOpen:R,onClose:()=>{h(!1)},onConfirm:ee,residentId:w})]})]})}export{ht as default};
